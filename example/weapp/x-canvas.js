!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n="undefined"!=typeof globalThis?globalThis:n||self).XCanvas=e()}(this,(function(){"use strict";var n=function(){return n=Object.assign||function(n){for(var e,t=arguments,r=1,o=arguments.length;r<o;r++)for(var i in e=t[r])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},n.apply(this,arguments)};var e=Object.freeze({}),t=Object.freeze([]),r=/^on[^a-z]/,o=function(n){return r.test(n)},i=Array.isArray,l=function(n){return"function"==typeof n},u=function(n){return"string"==typeof n},c=function(n){return null!==n&&"object"==typeof n};function a(n){if(i(n)){for(var e={},t=0;t<n.length;t++){var r=n[t],o=u(r)?v(r):a(r);if(o)for(var l in o)e[l]=o[l]}return e}return u(n)||c(n)?n:void 0}!function(){try{return Boolean(wx.getSystemInfoSync)}catch(n){return!1}}();var f,p=/;(?![^(]*\))/g,d=/:([^]+)/,s=/\/\*.*?\*\//gs;function v(n){var e={};return n.replace(s,"").split(p).forEach((function(n){if(n){var t=n.split(d);t.length>1&&(e[t[0].trim()]=t[1].trim())}})),e}function h(n){var e="";if(u(n))e=n;else if(i(n))for(var t=0;t<n.length;t++){var r=h(n[t]);r&&(e+=r+" ")}else if(c(n))for(var o in n)n[o]&&(e+=o+" ");return e.trim()}(f={})[1]="TEXT",f[2]="CLASS",f[4]="STYLE",f[8]="PROPS",f[16]="FULL_PROPS",f[32]="HYDRATE_EVENTS",f[64]="STABLE_FRAGMENT",f[128]="KEYED_FRAGMENT",f[256]="UNKEYED_FRAGMENT",f[512]="NEED_PATCH",f[1024]="DYNAMIC_SLOTS",f[2048]="DEV_ROOT_FRAGMENT",f[-1]="HOISTED",f[-2]="BAIL";var y=Symbol.for("v-fgt"),_=Symbol.for("v-cmt");function g(n){return!!n&&!0===n.__v_isVNode}function x(n,e,t,r){if(void 0===e&&(e=null),void 0===t&&(t=null),g(n)){var o=m(n,e);return t&&function(n,e){null==e?e=null:i(e)||"object"==typeof e||l(e)||(e=[C(e)]);n.children=e}(o,t),o}if(e){var f=e.class,p=e.style;f&&!u(f)&&(e.class=h(f)),c(p)&&(e.style=a(p))}return function(n,e,t,r){return void 0===e&&(e=null),void 0===t&&(t=null),{__v_isVNode:!0,__v_skip:!0,type:n,props:e,children:t,component:null,el:null,staticCount:0,appContext:null,ctx:null}}(n,e,t)}function m(n,e,t){if(n&&"object"!=typeof n)return n;var r=n.props,l=n.children,u=e?function(){for(var n=arguments,e=[],t=0;t<arguments.length;t++)e[t]=n[t];for(var r={},l=0;l<e.length;l++){var u=e[l];for(var c in u)if("class"===c)r.class!==u.class&&(r.class=h([r.class,u.class]));else if("style"===c)r.style=a([r.style,u.style]);else if(o(c)){var f=r[c],p=u[c];!p||f===p||i(f)&&f.includes(p)||(r[c]=f?[].concat(f,p):p)}else""!==c&&(r[c]=u[c])}return r}(r||{},e):r;return{__v_isVNode:!0,type:n.type,props:u,children:i(l)?l.map(E):l,staticCount:n.staticCount,appContext:n.appContext,component:n.component,el:n.el,ctx:n.ctx}}function E(n){var e=m(n);return i(n.children)&&(e.children=n.children.map(E)),e}function C(n,e){return void 0===n&&(n=" "),x("Text",null,n)}function b(n){return null==n||"boolean"==typeof n?x(_):i(n)?x(y,null,n.slice()):"object"==typeof n?function(n){return m(n)}(n):C(String(n))}var T=0;function A(n){return function(e,t){void 0===t&&(t=null);var r={_uid:T++,_component:e,_props:t,_container:null,_instance:null,mount:function(o){var i=x(e,t);r._container=o,n(i,o)}};return r}}var N=[],S=[],w=null,O=0,R=100;function j(n){if(S.length){var e=function(n,e,t){if(t||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return n.concat(r||Array.prototype.slice.call(e))}([],new Set(S),!0);if(S.length=0,w)return void w.push.apply(w,e);for(w=e,n=n||new Map,w.sort((function(n,e){return D(n)-D(e)})),O=0;O<w.length;O++)M(n,w[O])||w[O]();w=null,O=0}}var D=function(n){return null==n.id?1/0:n.id};function M(n,e){if(n.has(e)){var t=n.get(e);if(t>R)return!0;n.set(e,t+1)}else n.set(e,1)}function P(n){return{canvas:n.canvas,ctx:n.ctx,dpr:n.dpr||1,render:function(){}}}function L(n){return!!n&&!0===n.__v_isTreeNode}function k(n){return n.paint=function(){var n=this.getRenderer();this.options.render?this.options.render(n.getCtx(),n.getCanvas(),this):(n._drawBackground(this),n._drawBox(this))},n}function B(n){return n.debugColor="blue",n.paint=function(){},n}var V=function(n){return e=n.reverse(),r=e.length,o=0,function n(){for(var i=arguments,l=[],u=0;u<arguments.length;u++)l[u]=i[u];return t=e[o].apply(this,l),o>=r-1?(o=0,t):(o++,n.call(null,t))};var e,t,r,o};function F(e,t,r){void 0===t&&(t={});var o=n(n({},{__v_isCanvasElement:!0,type:e,options:t,styles:{},node:null,debugColor:null}),{appendChild:function(n){i.appendChild(n.node)},getContainer:function(){return o.node.parent?o.node.parent.context:null},isVisible:function(){return!0}}),i=function(n){var e={__v_isTreeNode:!0,_children:[],parent:null,root:null,prev:null,next:null,context:n.context,get children(){return e._children},hasChildren:function(){return!(!Array.isArray(e._children)||!e._children.length)},appendChild:function(n){if(!L(n))throw Error("Unknown treeNode type");var r=e._children[e._children.length-1]||null;r&&L(r)&&t(r,r.prev,n),Array.isArray(e._children)&&e._children.push(n),function(n,e){n.parent=e}(n,e),t(n,r,null)},prependChild:function(n){if(!L(n))throw Error("Unknown treeNode type")},removeChild:function(n){if(!L(n))throw Error("Unknown treeNode type")},append:function(){},prepend:function(){},remove:function(){}};function t(n,e,t){n.prev=e,n.next=t}return e}({context:o});return o.node=i,"body"===o.type&&(o.styles={width:"100%",height:"100%"}),o}function I(n,e,t){return void 0===e&&(e={}),"text"===n?V([B,F])(n,e,t):V([k,F])(n,e,t)}var U={createAppAPI:A,createNodeOps:function(n){return{insert:function(n,e,t){n&&e.appendChild(n)},remove:function(n){},createElement:function(e,t){var r=(t=t||{}).style;return n("view",{style:r})},createText:function(e){return n("text",{},e)},createComment:function(n){},setText:function(n,e){},setElementText:function(n,e){},parentNode:function(n){return n.parentNode},nextSibling:function(n){return n.nextSibling}}},createRenderer:function(n){var r=n.insert,o=n.remove,i=n.patchProp,l=n.createElement,u=n.createText;n.createComment;var c=n.setText,a=n.setElementText;n.parentNode;var f=n.nextSibling,p=function(n,e,t,r,o){if(void 0===r&&(r=null),void 0===o&&(o=null),n!==e)if(n&&!function(n,e){return n.type===e.type}(n,e)&&(r=T(n),m(n,o,!0),n=null),"Text"===e.type)d(n,e,t,r);else s(n,e,t,r,o)},d=function(n,e,t,o){null==n?r(u(e.children),t,o):e.children!==n.children&&c(e,e.children)},s=function(n,e,t,r,o){null==n?v(e,t,r,o):y(n,e,o)},v=function(n,e,t,o){var i;n.type;var u=n.props;i=n.el=l(n.type,u),h(n.children,i,null,o),r(i,e,t)},h=function(n,e,t,r,o){if(void 0===o&&(o=0),"string"==typeof n)p(null,b(n),e,t,r);else for(var i=o;i<n.length;i++){var l=b(n[i]);p(null,l,e,t,r)}},y=function(n,t,r){var o=t.el=n.el,i=n.props||e,l=t.props||e;_(n,t,o,null,r),n.children!==t.children&&a(o,t.children),x(o,t,i,l,r)},_=function(n,e,t,r,o){var i=n&&n.children,l=e.children;g(i,l,t,r,o)},g=function(n,e,r,o,i){e=e||t;var l,u=(n=n||t).length,c=e.length,a=Math.min(u,c);for(l=0;l<a;l++){var f=b(e[l]);p(n[l],f,r,null,i)}u>c?C(n,i,!0,!1,a):h(e,r,o,i,a)},x=function(n,t,r,o,l){if(r!==o){if(r!==e)for(var u in r)i(n,u,r[u],null,t.children,l,C);for(var u in o){var c=o[u],a=r[u];c!==a&&"value"!==u&&i(n,u,a,c,t.children,l,C)}"value"in o&&i(n,"value",r.value,o.value)}},m=function(n,e,t,r){void 0===t&&(t=!1),n.type,n.props;var o=n.children;C(o,e),t&&E(n)},E=function(n){o(n)},C=function(n,e,t,r,o){void 0===t&&(t=!1),void 0===o&&(o=0);for(var i=o;i<n.length;i++)m(n[i],e,t)},T=function(n){return f(n)},S=function(n,e){null==n?e._vnode&&m(e._vnode,null,!0):p(e._vnode||null,n,e,null,null),function(n,e){for(void 0===e&&(e=0),n=n||new Map;e<N.length;e++){var t=N[e];if(t&&t.pre){if(M(n,t))continue;N.splice(e,1),e--,t()}}}(),j(),e._vnode=n};return{render:S,createApp:A(S)}},h:function(n,e,t){var r=arguments.length;return 2===r?c(e)&&!i(e)?g(e)?x(n,null,[e]):x(n,e):x(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):3===r&&g(t)&&(t=[t]),x(n,e,t))},createDoCanvas:function(n){var e,t={context:(e={stackingContext:null,body:I("body"),getBody:function(){return e.body}},console.log(e.body),e),renderer:P(n),createElement:I};return t.renderer.render(),t}};return U}));
//# sourceMappingURL=x-canvas.js.map
