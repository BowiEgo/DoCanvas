{"version":3,"file":"x-canvas.js","sources":["../../src/utils/general.ts","../../src/utils/boxModel.ts","../../src/utils/device.ts","../../src/utils/normalizeProp.ts","../../src/utils/patchFlags.ts","../../src/vnode.ts","../../src/createApp.ts","../../node_modules/tslib/tslib.es6.js","../../src/scheduler.ts","../../src/canvas/treeNode.ts","../../src/canvas/styleConstant.ts","../../src/canvas/completeStyles.ts","../../src/canvas/line.ts","../../src/canvas/flexBox.ts","../../src/canvas/element.ts","../../src/canvas/text.ts","../../src/canvas/view.ts","../../src/utils/traversal.ts","../../src/canvas/renderer.ts","../../src/utils/throttle.ts","../../src/canvas/weapp-adapter.ts","../../src/index.ts","../../src/nodeOps.ts","../../src/renderer.ts","../../src/h.ts","../../src/canvas/layer.ts"],"sourcesContent":["export const EMPTY_OBJ = Object.freeze({})\nexport const EMPTY_ARR = Object.freeze([])\n\nexport const NOOP = () => {}\n\n/**\n * Always return false.\n */\nexport const NO = () => false\n\nconst onRE = /^on[^a-z]/\nexport const isOn = (key: string) => onRE.test(key)\n\nexport const isModelListener = (key: string) => key.startsWith('onUpdate:')\n\nexport const extend = Object.assign\n\nexport const remove = <T>(arr: T[], el: T) => {\n  const i = arr.indexOf(el)\n  if (i > -1) {\n    arr.splice(i, 1)\n  }\n}\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty\nexport const hasOwn = (\n  val: object,\n  key: string | symbol\n): key is keyof typeof val => hasOwnProperty.call(val, key)\n\nexport const isExact = (num: unknown) => {\n  return typeof num === 'number'\n}\n\nexport const isAuto = (num: unknown) => {\n  return num === 'auto'\n}\n\nexport const isOuter = (num: unknown) => {\n  if (typeof num !== 'string') return\n  return num.match('%')\n}\n\nexport const parseOuter = (num: string) => {\n  let _n = parseInt(num.replace('%', ''))\n  return isNaN(_n) || _n < 0 ? 0 : _n / 100\n}\n\nexport const isArray = Array.isArray\nexport const isMap = (val: unknown): val is Map<any, any> =>\n  toTypeString(val) === '[object Map]'\nexport const isSet = (val: unknown): val is Set<any> =>\n  toTypeString(val) === '[object Set]'\n\nexport const isDate = (val: unknown): val is Date =>\n  toTypeString(val) === '[object Date]'\nexport const isRegExp = (val: unknown): val is RegExp =>\n  toTypeString(val) === '[object RegExp]'\nexport const isFunction = (val: unknown): val is Function =>\n  typeof val === 'function'\nexport const isString = (val: unknown): val is string => typeof val === 'string'\nexport const isSymbol = (val: unknown): val is symbol => typeof val === 'symbol'\nexport const isObject = (val: unknown): val is Record<any, any> =>\n  val !== null && typeof val === 'object'\n\nexport const isPromise = <T = any>(val: unknown): val is Promise<T> => {\n  return isObject(val) && isFunction(val.then) && isFunction(val.catch)\n}\n\nexport const objectToString = Object.prototype.toString\nexport const toTypeString = (value: unknown): string =>\n  objectToString.call(value)\n\nexport const toRawType = (value: unknown): string => {\n  // extract \"RawType\" from strings like \"[object RawType]\"\n  return toTypeString(value).slice(8, -1)\n}\n\nexport const isPlainObject = (val: unknown): val is object =>\n  toTypeString(val) === '[object Object]'\n\nexport const isIntegerKey = (key: unknown) =>\n  isString(key) &&\n  key !== 'NaN' &&\n  key[0] !== '-' &&\n  '' + parseInt(key, 10) === key\n","import { CanvasElement, isCanvasElement } from '../canvas/element'\nimport { TreeNodeChildren } from '../canvas/treeNode'\nimport { isArray } from './general'\n\nexport function floor(val) {\n  return (0.5 + val) << 0\n}\n\nexport function walk(element, callback) {\n  let _continue = false // 是否跳过当前节点以及后面的节点\n  let _next = false // 是否跳过当前节点数，子元素都不会遍历\n  const _callContinue = () => (_continue = true)\n  const _callNext = () => (_next = true)\n  if (element != null) {\n    const stack: CanvasElement[] = []\n    let item: CanvasElement | undefined | null = null\n    let children: TreeNodeChildren = []\n    stack.push(element)\n    while (stack.length !== 0) {\n      item = stack.pop()\n      if (!item) break\n      callback(item, _callContinue, _callNext)\n      if (!_next && item) {\n        children = item.children\n        if (isArray(children)) {\n          for (let i = children.length - 1; i >= 0; i--) {\n            if (!_continue) {\n              stack.push(children[i])\n            } else {\n              // 复位\n              _continue = false\n            }\n          }\n        }\n      } else {\n        // 复位\n        _next = false\n      }\n    }\n  }\n}\n\nexport function walkParent(element, callback) {\n  if (!element) return\n  let cur = element\n  let stop = false\n  const callbreak = () => {\n    stop = true\n  }\n  while (cur.parent) {\n    callback(cur.parent, callbreak)\n    if (stop) {\n      break\n    }\n    cur = cur.parent\n  }\n}\n\nexport function findRelativeTo(element) {\n  if (element.isInFlow()) return element.parent\n  if (element.renderStyles.position === 'fixed') return element.root\n  let relativeTo = null\n  walkParent(element, (parent) => {\n    if (parent.renderStyles.position !== 'static' && !relativeTo) {\n      relativeTo = parent\n    }\n  })\n  if (!relativeTo) {\n    relativeTo = element.root\n  }\n  return relativeTo\n}\n","export const isWX = (function () {\n  try {\n    return Boolean(wx.getSystemInfoSync)\n  } catch (err) {\n    return false\n  }\n})()\n","import { isString, isArray, isObject } from './general'\n\nexport type NormalizedStyle = Record<string, string | number>\n\nexport function normalizeStyle(\n  value: unknown\n): NormalizedStyle | string | undefined {\n  if (isArray(value)) {\n    const res: NormalizedStyle = {}\n    for (let i = 0; i < value.length; i++) {\n      const item = value[i]\n      const normalized = isString(item)\n        ? parseStringStyle(item)\n        : (normalizeStyle(item) as NormalizedStyle)\n      if (normalized) {\n        for (const key in normalized) {\n          res[key] = normalized[key]\n        }\n      }\n    }\n    return res\n  } else if (isString(value)) {\n    return value\n  } else if (isObject(value)) {\n    return value\n  }\n}\n\nconst listDelimiterRE = /;(?![^(]*\\))/g\nconst propertyDelimiterRE = /:([^]+)/\nconst styleCommentRE = /\\/\\*.*?\\*\\//gs\n\nexport function parseStringStyle(cssText: string): NormalizedStyle {\n  const ret: NormalizedStyle = {}\n  cssText\n    .replace(styleCommentRE, '')\n    .split(listDelimiterRE)\n    .forEach((item) => {\n      if (item) {\n        const tmp = item.split(propertyDelimiterRE)\n        tmp.length > 1 && (ret[tmp[0].trim()] = tmp[1].trim())\n      }\n    })\n  return ret\n}\n\nexport function normalizeClass(value: unknown): string {\n  let res = ''\n  if (isString(value)) {\n    res = value\n  } else if (isArray(value)) {\n    for (let i = 0; i < value.length; i++) {\n      const normalized = normalizeClass(value[i])\n      if (normalized) {\n        res += normalized + ' '\n      }\n    }\n  } else if (isObject(value)) {\n    for (const name in value) {\n      if (value[name]) {\n        res += name + ' '\n      }\n    }\n  }\n  return res.trim()\n}\n","/**\n * Patch flags are optimization hints generated by the compiler.\n * when a block with dynamicChildren is encountered during diff, the algorithm\n * enters \"optimized mode\". In this mode, we know that the vdom is produced by\n * a render function generated by the compiler, so the algorithm only needs to\n * handle updates explicitly marked by these patch flags.\n *\n * Patch flags can be combined using the | bitwise operator and can be checked\n * using the & operator, e.g.\n *\n * ```js\n * const flag = TEXT | CLASS\n * if (flag & TEXT) { ... }\n * ```\n *\n * Check the `patchElement` function in '../../runtime-core/src/renderer.ts' to see how the\n * flags are handled during diff.\n */\nexport const enum PatchFlags {\n  /**\n   * Indicates an element with dynamic textContent (children fast path)\n   */\n  TEXT = 1,\n\n  /**\n   * Indicates an element with dynamic class binding.\n   */\n  CLASS = 1 << 1,\n\n  /**\n   * Indicates an element with dynamic style\n   * The compiler pre-compiles static string styles into static objects\n   * + detects and hoists inline static objects\n   * e.g. `style=\"color: red\"` and `:style=\"{ color: 'red' }\"` both get hoisted\n   * as:\n   * ```js\n   * const style = { color: 'red' }\n   * render() { return e('div', { style }) }\n   * ```\n   */\n  STYLE = 1 << 2,\n\n  /**\n   * Indicates an element that has non-class/style dynamic props.\n   * Can also be on a component that has any dynamic props (includes\n   * class/style). when this flag is present, the vnode also has a dynamicProps\n   * array that contains the keys of the props that may change so the runtime\n   * can diff them faster (without having to worry about removed props)\n   */\n  PROPS = 1 << 3,\n\n  /**\n   * Indicates an element with props with dynamic keys. When keys change, a full\n   * diff is always needed to remove the old key. This flag is mutually\n   * exclusive with CLASS, STYLE and PROPS.\n   */\n  FULL_PROPS = 1 << 4,\n\n  /**\n   * Indicates an element with event listeners (which need to be attached\n   * during hydration)\n   */\n  HYDRATE_EVENTS = 1 << 5,\n\n  /**\n   * Indicates a fragment whose children order doesn't change.\n   */\n  STABLE_FRAGMENT = 1 << 6,\n\n  /**\n   * Indicates a fragment with keyed or partially keyed children\n   */\n  KEYED_FRAGMENT = 1 << 7,\n\n  /**\n   * Indicates a fragment with unkeyed children.\n   */\n  UNKEYED_FRAGMENT = 1 << 8,\n\n  /**\n   * Indicates an element that only needs non-props patching, e.g. ref or\n   * directives (onVnodeXXX hooks). since every patched vnode checks for refs\n   * and onVnodeXXX hooks, it simply marks the vnode so that a parent block\n   * will track it.\n   */\n  NEED_PATCH = 1 << 9,\n\n  /**\n   * Indicates a component with dynamic slots (e.g. slot that references a v-for\n   * iterated value, or dynamic slot names).\n   * Components with this flag are always force updated.\n   */\n  DYNAMIC_SLOTS = 1 << 10,\n\n  /**\n   * Indicates a fragment that was created only because the user has placed\n   * comments at the root level of a template. This is a dev-only flag since\n   * comments are stripped in production.\n   */\n  DEV_ROOT_FRAGMENT = 1 << 11,\n\n  /**\n   * SPECIAL FLAGS -------------------------------------------------------------\n   * Special flags are negative integers. They are never matched against using\n   * bitwise operators (bitwise matching should only happen in branches where\n   * patchFlag > 0), and are mutually exclusive. When checking for a special\n   * flag, simply check patchFlag === FLAG.\n   */\n\n  /**\n   * Indicates a hoisted static vnode. This is a hint for hydration to skip\n   * the entire sub tree since static content never needs to be updated.\n   */\n  HOISTED = -1,\n  /**\n   * A special flag that indicates that the diffing algorithm should bail out\n   * of optimized mode. For example, on block fragments created by renderSlot()\n   * when encountering non-compiler generated slots (i.e. manually written\n   * render functions, which should always be fully diffed)\n   * OR manually cloneVNodes\n   */\n  BAIL = -2\n}\n\n/**\n * dev only flag -> name mapping\n */\nexport const PatchFlagNames: Record<PatchFlags, string> = {\n  [PatchFlags.TEXT]: `TEXT`,\n  [PatchFlags.CLASS]: `CLASS`,\n  [PatchFlags.STYLE]: `STYLE`,\n  [PatchFlags.PROPS]: `PROPS`,\n  [PatchFlags.FULL_PROPS]: `FULL_PROPS`,\n  [PatchFlags.HYDRATE_EVENTS]: `HYDRATE_EVENTS`,\n  [PatchFlags.STABLE_FRAGMENT]: `STABLE_FRAGMENT`,\n  [PatchFlags.KEYED_FRAGMENT]: `KEYED_FRAGMENT`,\n  [PatchFlags.UNKEYED_FRAGMENT]: `UNKEYED_FRAGMENT`,\n  [PatchFlags.NEED_PATCH]: `NEED_PATCH`,\n  [PatchFlags.DYNAMIC_SLOTS]: `DYNAMIC_SLOTS`,\n  [PatchFlags.DEV_ROOT_FRAGMENT]: `DEV_ROOT_FRAGMENT`,\n  [PatchFlags.HOISTED]: `HOISTED`,\n  [PatchFlags.BAIL]: `BAIL`\n}\n","import {\n  isOn,\n  isString,\n  isObject,\n  isArray,\n  isFunction,\n  normalizeClass,\n  normalizeStyle\n} from './utils'\nimport { RendererNode } from './renderer'\nimport { ComponentInternalInstance, Data } from './components'\nimport { AppContext } from './createApp'\n\nexport const Fragment = Symbol.for('v-fgt') as any as {\n  __isFragment: true\n  new (): {\n    $props: VNodeProps\n  }\n}\nexport const Text = Symbol.for('v-txt')\nexport const Comment = Symbol.for('v-cmt')\n\nexport type VNodeTypes =\n  | string\n  | VNode\n  | typeof Text\n  | typeof Comment\n  | typeof Fragment\n\nexport type VNodeProps = {\n  key?: string | number | symbol\n  ref_for?: boolean\n  ref_key?: string\n}\n\ntype VNodeChildAtom =\n  | VNode\n  | string\n  | number\n  | boolean\n  | null\n  | undefined\n  | void\n\nexport type VNodeArrayChildren = Array<VNodeArrayChildren | VNodeChildAtom>\n\nexport type VNodeChild = VNodeChildAtom | VNodeArrayChildren\n\nexport type VNodeNormalizedChildren = string | VNodeArrayChildren | null\n\nexport interface VNode<\n  HostNode = RendererNode,\n  ExtraProps = { [key: string]: any }\n> {\n  /**\n   * @internal\n   */\n  __v_isVNode: true\n\n  type: VNodeTypes\n  props: (VNodeProps & ExtraProps) | null\n  children: VNodeNormalizedChildren\n  component: ComponentInternalInstance | null\n\n  el: HostNode | null\n  /**\n   * number of elements contained in a static vnode\n   * @internal\n   */\n  staticCount: number\n\n  // application root node only\n  appContext: AppContext | null\n\n  /**\n   * @internal lexical scope owner instance\n   */\n  ctx: ComponentInternalInstance | null\n}\n\nexport function isVNode(value: any): value is VNode {\n  return value ? value.__v_isVNode === true : false\n}\n\nexport function isSameVNodeType(n1: VNode, n2: VNode): boolean {\n  return n1.type === n2.type\n}\n\nfunction createBaseVNode(\n  type: VNodeTypes,\n  props: (Data & VNodeProps) | null = null,\n  children: unknown = null,\n  patchFlag = 0\n) {\n  const vnode = {\n    __v_isVNode: true,\n    __v_skip: true,\n    type,\n    props,\n    children,\n    component: null,\n    el: null,\n    staticCount: 0,\n    appContext: null,\n    ctx: null\n  } as VNode\n\n  // if (type !== 'Text') {\n  //   normalizeChildren(vnode, children)\n  // }\n  return vnode\n}\n\nexport function createVNode(\n  type: VNodeTypes,\n  props: (Data & VNodeProps) | null = null,\n  children: unknown = null,\n  patchFlag: number = 0\n) {\n  if (isVNode(type)) {\n    const cloned = cloneVNode(type, props, true /* mergeRef: true */)\n    if (children) {\n      normalizeChildren(cloned, children)\n    }\n\n    return cloned\n  }\n\n  // class & style normalization.\n  if (props) {\n    // for reactive or proxy objects, we need to clone it to enable mutation.\n    // props = guardReactiveProps(props)!\n    let { class: klass, style } = props\n    if (klass && !isString(klass)) {\n      props.class = normalizeClass(klass)\n    }\n    if (isObject(style)) {\n      props.style = normalizeStyle(style)\n    }\n  }\n\n  return createBaseVNode(type, props, children, patchFlag)\n}\n\nexport function cloneVNode(\n  vnode: VNode,\n  extraProps?: (Data & VNodeProps) | null,\n  mergeRef = false\n): VNode {\n  if (vnode && typeof vnode !== 'object') {\n    return vnode\n  }\n  // This is intentionally NOT using spread or extend to avoid the runtime\n  // key enumeration cost.\n  const { props, children } = vnode\n  const mergedProps = extraProps ? mergeProps(props || {}, extraProps) : props\n  const cloned: VNode = {\n    __v_isVNode: true,\n    type: vnode.type,\n    props: mergedProps,\n    children: isArray(children)\n      ? (children as VNode[]).map(deepCloneVNode)\n      : children,\n    staticCount: vnode.staticCount,\n    appContext: vnode.appContext,\n    component: vnode.component,\n    el: vnode.el,\n    ctx: vnode.ctx\n  }\n  return cloned as any\n}\n\n/**\n * Dev only, for HMR of hoisted vnodes reused in v-for\n * https://github.com/vitejs/vite/issues/2022\n */\nfunction deepCloneVNode(vnode: VNode): VNode {\n  const cloned = cloneVNode(vnode)\n  if (isArray(vnode.children)) {\n    cloned.children = (vnode.children as VNode[]).map(deepCloneVNode)\n  }\n  return cloned\n}\n\n/**\n * @private\n */\nexport function createTextVNode(text: string = ' ', flag: number = 0): VNode {\n  return createVNode('Text', null, text)\n}\n\nexport function normalizeVNode(child: VNodeChild): VNode {\n  if (child == null || typeof child === 'boolean') {\n    // empty placeholder\n    return createVNode(Comment)\n  } else if (isArray(child)) {\n    // fragment\n    return createVNode(\n      Fragment,\n      null,\n      // #3666, avoid reference pollution when reusing vnode\n      child.slice()\n    )\n  } else if (typeof child === 'object') {\n    // already vnode, this should be the most common since compiled templates\n    // always produce all-vnode children arrays\n    return cloneIfMounted(child)\n  } else {\n    // strings and numbers\n    return createTextVNode(String(child))\n  }\n}\n\nexport function cloneIfMounted(child: VNode): VNode {\n  return cloneVNode(child)\n}\n\nexport function normalizeChildren(vnode: VNode, children: unknown) {\n  if (children == null) {\n    children = null\n  } else if (isArray(children)) {\n  } else if (typeof children === 'object') {\n  } else if (isFunction(children)) {\n  } else {\n    children = [createTextVNode(children as string)]\n  }\n  vnode.children = children as VNodeNormalizedChildren\n}\n\nexport function mergeProps(...args: (Data & VNodeProps)[]) {\n  const ret: Data = {}\n  for (let i = 0; i < args.length; i++) {\n    const toMerge = args[i]\n    for (const key in toMerge) {\n      if (key === 'class') {\n        if (ret.class !== toMerge.class) {\n          ret.class = normalizeClass([ret.class, toMerge.class])\n        }\n      } else if (key === 'style') {\n        ret.style = normalizeStyle([ret.style, toMerge.style])\n      } else if (isOn(key)) {\n        const existing = ret[key]\n        const incoming = toMerge[key]\n        if (\n          incoming &&\n          existing !== incoming &&\n          !(isArray(existing) && existing.includes(incoming))\n        ) {\n          ret[key] = existing\n            ? [].concat(existing as any, incoming as any)\n            : incoming\n        }\n      } else if (key !== '') {\n        ret[key] = toMerge[key]\n      }\n    }\n  }\n  return ret\n}\n","import { Component, ComponentInternalInstance, Data } from './components'\nimport { createVNode } from './vnode'\n\nexport interface App<HostElement = any> {\n  _uid: number\n  _component: Component\n  _props: Data | null\n  _container: HostElement | null\n  _instance: ComponentInternalInstance | null\n\n  mount(rootContainer: HostElement | string): any\n}\n\nexport interface AppContext {\n  app: App // for devtools\n}\n\nexport type createApp<HostElement> = (\n  rootComponent: Component,\n  rootProps?: Data | null\n) => App<HostElement>\n\nlet uid = 0\n\nexport function createAppAPI(render) {\n  return function createApp(rootComponent, rootProps = null) {\n    const app: App = {\n      _uid: uid++,\n      _component: rootComponent as Component,\n      _props: rootProps,\n      _container: null,\n      _instance: null,\n\n      mount(rootContainer): any {\n        const vnode = createVNode(rootComponent, rootProps)\n\n        app._container = rootContainer\n\n        render(vnode, rootContainer)\n      }\n    }\n\n    return app\n  }\n}\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.push(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.push(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","import { ComponentInternalInstance } from './components'\n\nexport interface SchedulerJob extends Function {\n  id?: number\n  pre?: boolean\n  active?: boolean\n  computed?: boolean\n  /**\n   * Indicates whether the effect is allowed to recursively trigger itself\n   * when managed by the scheduler.\n   *\n   * By default, a job cannot trigger itself because some built-in method calls,\n   * e.g. Array.prototype.push actually performs reads as well (#1740) which\n   * can lead to confusing infinite loops.\n   * The allowed cases are component update functions and watch callbacks.\n   * Component update functions may update child component props, which in turn\n   * trigger flush: \"pre\" watch callbacks that mutates state that the parent\n   * relies on (#1801). Watch callbacks doesn't track its dependencies so if it\n   * triggers itself again, it's likely intentional and it is the user's\n   * responsibility to perform recursive state mutation that eventually\n   * stabilizes (#1727).\n   */\n  allowRecurse?: boolean\n  /**\n   * Attached by renderer.ts when setting up a component's render effect\n   * Used to obtain component information when reporting max recursive updates.\n   * dev only.\n   */\n  ownerInstance?: ComponentInternalInstance\n}\n\nexport type SchedulerJobs = SchedulerJob | SchedulerJob[]\n\nlet isFlushing = false\nlet isFlushPending = false\n\nconst queue: SchedulerJob[] = []\nlet flushIndex = 0\n\nconst pendingPostFlushCbs: SchedulerJob[] = []\nlet activePostFlushCbs: SchedulerJob[] | null = null\nlet postFlushIndex = 0\n\nconst resolvedPromise = /*#__PURE__*/ Promise.resolve() as Promise<any>\nlet currentFlushPromise: Promise<void> | null = null\n\nconst RECURSION_LIMIT = 100\ntype CountMap = Map<SchedulerJob, number>\n\nexport function flushPreFlushCbs(\n  seen?: CountMap,\n  // if currently flushing, skip the current job itself\n  i = isFlushing ? flushIndex + 1 : 0\n) {\n  seen = seen || new Map()\n  for (; i < queue.length; i++) {\n    const cb = queue[i]\n    if (cb && cb.pre) {\n      if (checkRecursiveUpdates(seen!, cb)) {\n        continue\n      }\n      queue.splice(i, 1)\n      i--\n      cb()\n    }\n  }\n}\n\nexport function flushPostFlushCbs(seen?: CountMap) {\n  if (pendingPostFlushCbs.length) {\n    const deduped = [...new Set(pendingPostFlushCbs)]\n    pendingPostFlushCbs.length = 0\n\n    // #1947 already has active queue, nested flushPostFlushCbs call\n    if (activePostFlushCbs) {\n      activePostFlushCbs.push(...deduped)\n      return\n    }\n\n    activePostFlushCbs = deduped\n\n    seen = seen || new Map()\n\n    activePostFlushCbs.sort((a, b) => getId(a) - getId(b))\n\n    for (\n      postFlushIndex = 0;\n      postFlushIndex < activePostFlushCbs.length;\n      postFlushIndex++\n    ) {\n      if (checkRecursiveUpdates(seen!, activePostFlushCbs[postFlushIndex])) {\n        continue\n      }\n      activePostFlushCbs[postFlushIndex]()\n    }\n    activePostFlushCbs = null\n    postFlushIndex = 0\n  }\n}\n\nconst getId = (job: SchedulerJob): number =>\n  job.id == null ? Infinity : job.id\n\nfunction checkRecursiveUpdates(seen: CountMap, fn: SchedulerJob) {\n  if (!seen.has(fn)) {\n    seen.set(fn, 1)\n  } else {\n    const count = seen.get(fn)!\n    if (count > RECURSION_LIMIT) {\n      return true\n    } else {\n      seen.set(fn, count + 1)\n    }\n  }\n}\n","export type TreeNodeChildren = Array<any> | string\n\nexport interface TreeNode {\n  __v_isTreeNode: boolean\n  _children: TreeNodeChildren\n  parent: TreeNode | null\n  root: TreeNode | null\n  prev: TreeNode | string | null\n  next: TreeNode | string | null\n  children: TreeNodeChildren\n  // parent: TreeNode | null\n  _setParent(node: TreeNode): void\n  _setSibling(prev: TreeNode | string | null, next: TreeNode | null): void\n  hasChildren(): boolean\n  appendChild(child: TreeNode): void\n  prependChild(child: TreeNode): void\n  removeChild(child: TreeNode): void\n  append(): void\n  prepend(): void\n  remove(): void\n}\n\nexport function isTreeNode(value: any): value is TreeNode {\n  return value ? value.__v_isTreeNode === true : false\n}\n\nexport function isEndNode(node) {\n  return node.parent && !node.next && !node.hasChildren()\n}\n\nexport function createTreeNode(children: TreeNodeChildren = []) {\n  const treeNode: TreeNode = {\n    __v_isTreeNode: true,\n    _children: children,\n    parent: null,\n    root: null,\n    prev: null,\n    next: null,\n\n    get children() {\n      return treeNode._children\n    },\n\n    // get parent() {\n    //   return treeNode._parent\n    // },\n\n    _setParent(node) {\n      console.log('_setParent', treeNode, this, node)\n      treeNode.parent = node\n    },\n\n    _setSibling(prev, next) {\n      treeNode.prev = prev\n      treeNode.next = next\n    },\n\n    hasChildren() {\n      return Array.isArray(treeNode._children) && treeNode._children.length\n        ? true\n        : false\n    },\n\n    appendChild(child) {\n      if (!isTreeNode(child)) throw Error('Unknown treeNode type')\n\n      const prev = treeNode._children[treeNode._children.length - 1] || null\n      if (prev && isTreeNode(prev)) {\n        prev._setSibling(prev.prev, child)\n      }\n\n      Array.isArray(treeNode._children) && treeNode._children.push(child)\n\n      child._setParent(this)\n      child._setSibling(prev, null)\n    },\n\n    prependChild(child) {\n      if (!isTreeNode(child)) throw Error('Unknown treeNode type')\n    },\n\n    removeChild(child) {\n      if (!isTreeNode(child)) throw Error('Unknown treeNode type')\n    },\n\n    append() {},\n\n    prepend() {},\n\n    remove() {}\n  }\n\n  return treeNode\n}\n\nexport function connectChildren(el) {\n  if (el.hasChildren()) {\n    el.children = el.children.filter((item) => {\n      isTreeNode(item)\n    })\n    el._getChildren().map((child, index) => {\n      child._setParent(el)\n      child._setSibling(\n        el._getChildren()[index - 1],\n        el._getChildren()[index + 1]\n      )\n      connectChildren(child)\n    })\n  }\n}\n","type GlobalValue = 'inherit' | 'initial' | 'revert' | 'revert-layer' | 'unset'\n\nexport type TextAlign =\n  | 'start'\n  | 'end'\n  | 'left'\n  | 'right'\n  | 'center'\n  | 'justify'\n  | 'justify-all'\n  | 'match-parent'\n  | GlobalValue\n\nexport type VerticalAlign =\n  | 'middle'\n  | 'baseline'\n  | 'sub'\n  | 'super'\n  | 'text-top'\n  | 'text-bottom'\n  | 'top'\n  | 'bottom'\n  | 'inherit'\n  | 'initial'\n  | 'revert'\n  | 'revert-layer'\n  | 'unset'\n  | number\n  | GlobalValue\n\nexport type JustifyContent =\n  | 'center' /* Pack items around the center */\n  | 'start' /* Pack items from the start */\n  | 'end' /* Pack items from the end */\n  | 'flex-start' /* Pack flex items from the start */\n  | 'flex-end' /* Pack flex items from the end */\n  | 'left' /* Pack items from the left */\n  | 'right' /* Pack items from the right */\n  | 'normal'\n  /* Distributed alignment */\n  | 'space-between' /* Distribute items evenly\n                                   The first item is flush with the start,\n                                   the last is flush with the end */\n  | 'space-around' /* Distribute items evenly\n                                   Items have a half-size space\n                                   on either end */\n  | 'space-evenly' /* Distribute items evenly\n                                   Items have equal space around them */\n  | 'stretch' /* Distribute items evenly\n                                   Stretch 'auto'-sized items to fit\n                                   the container */\n  /* Overflow alignment */\n  | 'safe center'\n  | 'unsafe center'\n  | GlobalValue\n\nexport type AlignItems =\n  /* Basic keywords */\n  | 'normal'\n  | 'stretch'\n  /* Positional alignment */\n  /* align-items does not take left and right values */\n  | 'center' /* Pack items around the center */\n  | 'start' /* Pack items from the start */\n  | 'end' /* Pack items from the end */\n  | 'flex-start' /* Pack flex items from the start */\n  | 'flex-end' /* Pack flex items from the end */\n  | 'self-start' /* Pack flex items from the start */\n  | 'self-end' /* Pack flex items from the end */\n  /* Baseline alignment */\n  | 'baseline'\n  | 'first baseline'\n  | 'last baseline' /* Overflow alignment (for positional alignment only) */\n  | 'safe center'\n  | 'unsafe center'\n  | GlobalValue\n\nexport type AlignSelf =\n  /* Keyword values */\n  | 'auto'\n  | 'normal'\n  /* Positional alignment */\n  /* align-self does not take left and right values */\n  | 'center' /* Put the item around the center */\n  | 'start' /* Put the item at the start */\n  | 'end' /* Put the item at the end */\n  | 'self-start' /* Align the item flush at the start */\n  | 'self-end' /* Align the item flush at the end */\n  | 'flex-start' /* Put the flex item at the start */\n  | 'flex-end' /* Put the flex item at the end */\n  /* Baseline alignment */\n  | 'baseline'\n  | 'first baseline'\n  | 'last baseline'\n  | 'stretch' /* Stretch 'auto'-sized items to fit the container */\n  /* Overflow alignment */\n  | 'safe center'\n  | 'unsafe center'\n  | GlobalValue\n\nexport type WhiteSpace =\n  /* Keyword values */\n  | 'normal'\n  | 'nowrap'\n  | 'pre'\n  | 'pre-wrap'\n  | 'pre-line'\n  | 'break-spaces'\n  | GlobalValue\n\nexport type Position =\n  | 'static'\n  | 'relative'\n  | 'absolute'\n  | 'fixed'\n  | 'sticky'\n  | GlobalValue\n\nexport interface ElementStyleType {\n  display: string\n  fontSize: number\n  fontWeight: number\n  fontFamily: string\n  color: string\n  paddingTop: number\n  paddingBottom: number\n  paddingLeft: number\n  paddingRight: number\n  marginTop: number\n  marginBottom: number\n  marginLeft: number\n  marginRight: number\n  height: number | string\n  borderRadius: number\n  borderColor: string\n  lineCap: string\n  flex?: string | number\n  flexDirection: string\n  verticalAlign: VerticalAlign\n  textAlign: TextAlign\n  justifyContent: JustifyContent\n  alignItems: AlignItems\n  alignSelf: AlignSelf\n  whiteSpace: WhiteSpace\n  zIndex: number\n  visible: boolean\n  position: Position\n}\n\nconst DISPLAY = {\n  BLOCK: 'block',\n  INLINE_BLOCK: 'inline-block',\n  INLINE: 'inline', // 用户不能设置inline，text默认为inline\n  FLEX: 'flex',\n  NONE: 'none'\n}\n\nconst WIDTH = {\n  AUTO: 'auto',\n  OUTER: '100%'\n}\n\nconst POSITION = {\n  ABSOLUTE: 'absolute',\n  FIXED: 'fixed',\n  RELATIVE: 'relative',\n  STATIC: 'static'\n}\n\nconst TEXT_ALIGN = {\n  LEFT: 'left',\n  RIGHT: 'right',\n  CENTER: 'center'\n}\n\nconst FLEX_DIRECTION = {\n  ROW: 'row',\n  COLUMN: 'column'\n}\n\nconst DEFAULT_STYLES: ElementStyleType = {\n  display: DISPLAY.BLOCK,\n  fontSize: 14,\n  fontWeight: 400,\n  fontFamily: 'sans-serif',\n  color: '#000',\n  paddingTop: 0,\n  paddingBottom: 0,\n  paddingLeft: 0,\n  paddingRight: 0,\n  marginTop: 0,\n  marginBottom: 0,\n  marginLeft: 0,\n  marginRight: 0,\n  height: WIDTH.AUTO,\n  borderRadius: 0,\n  borderColor: '#000',\n  lineCap: 'square',\n  flexDirection: FLEX_DIRECTION.ROW,\n  verticalAlign: 'middle',\n  textAlign: 'left',\n  justifyContent: 'flex-start',\n  alignItems: 'flex-start',\n  alignSelf: 'auto',\n  whiteSpace: 'normal',\n  zIndex: 1,\n  visible: true,\n  position: 'static'\n}\n\nconst STYLE_CONSTANT = {\n  DISPLAY,\n  WIDTH,\n  POSITION,\n  TEXT_ALIGN,\n  FLEX_DIRECTION,\n  DEFAULT_STYLES\n} as const\n\nexport default STYLE_CONSTANT\n","import { isExact, isAuto, isOuter } from '../utils'\nimport CONSTANT from './styleConstant'\n\nexport default function (element) {\n  _completeFlex(element)\n\n  _completeWidth(element)\n\n  _completeBorder(element)\n\n  _completeFont(element)\n\n  _completePaddingMargin(element)\n}\n\nfunction _completePaddingMargin(element) {\n  if (element.styles.padding) {\n    if (isExact(element.styles.padding)) {\n      element.styles.paddingLeft = element.styles.padding\n      element.styles.paddingBottom = element.styles.padding\n      element.styles.paddingRight = element.styles.padding\n      element.styles.paddingTop = element.styles.padding\n    } else if (Array.isArray(element.styles.padding)) {\n      // 支持数组[10,20]相当于padding:10px 20px;\n      if (element.styles.padding.length === 2) {\n        element.styles.paddingLeft = element.styles.paddingRight =\n          element.styles.padding[1]\n        element.styles.paddingBottom = element.styles.paddingTop =\n          element.styles.padding[0]\n      } else if (element.styles.padding.length === 4) {\n        element.styles.paddingLeft = element.styles.padding[3]\n        element.styles.paddingBottom = element.styles.padding[2]\n        element.styles.paddingRight = element.styles.padding[1]\n        element.styles.paddingTop = element.styles.padding[0]\n      }\n    }\n  }\n\n  if (isExact(element.styles.margin)) {\n    element.styles.marginLeft = element.styles.margin\n    element.styles.marginBottom = element.styles.margin\n    element.styles.marginRight = element.styles.margin\n    element.styles.marginTop = element.styles.margin\n  } else if (Array.isArray(element.styles.margin)) {\n    // 支持数组[10,20]相当于padding:10px 20px;\n    if (element.styles.margin.length === 2) {\n      element.styles.marginLeft = element.styles.marginRight =\n        element.styles.margin[1]\n      element.styles.marginBottom = element.styles.marginTop =\n        element.styles.margin[0]\n    } else if (element.styles.margin.length === 4) {\n      element.styles.marginLeft = element.styles.margin[3]\n      element.styles.marginBottom = element.styles.margin[2]\n      element.styles.marginRight = element.styles.margin[1]\n      element.styles.marginTop = element.styles.margin[0]\n    }\n  }\n}\n\n/**\n * borderwidth到各个边\n */\nfunction _completeBorder(element) {\n  let {\n    borderWidth,\n    borderLeftWidth,\n    borderRightWidth,\n    borderBottomWidth,\n    borderTopWidth,\n    borderRadius\n  } = element.styles\n  if (!borderWidth) {\n    element.styles.borderWidth = 0\n    borderWidth = 0\n  }\n  if (Array.isArray(borderWidth)) {\n    element.styles.borderTopWidth = borderWidth[0]\n    element.styles.borderRightWidth = borderWidth[1]\n    element.styles.borderBottomWidth = borderWidth[2]\n    element.styles.borderLeftWidth = borderWidth[3]\n  } else {\n    if (!borderLeftWidth) {\n      element.styles.borderLeftWidth = borderWidth\n    }\n    if (!borderRightWidth) {\n      element.styles.borderRightWidth = borderWidth\n    }\n    if (!borderBottomWidth) {\n      element.styles.borderBottomWidth = borderWidth\n    }\n    if (!borderTopWidth) {\n      element.styles.borderTopWidth = borderWidth\n    }\n  }\n  if (borderRadius) {\n    element.styles.overflow = 'hidden'\n  }\n}\n\nfunction _completeWidth(element) {\n  if (!element.styles.width) {\n    if (\n      element.styles.display === CONSTANT.DISPLAY.INLINE_BLOCK ||\n      element.styles.display === CONSTANT.DISPLAY.INLINE ||\n      !element.isInFlow()\n    ) {\n      element.styles.width = CONSTANT.WIDTH.AUTO\n    } else if (\n      element.styles.display === CONSTANT.DISPLAY.BLOCK ||\n      element.styles.display === CONSTANT.DISPLAY.FLEX\n    ) {\n      element.styles.width = CONSTANT.WIDTH.OUTER\n    } else {\n      element.styles.width = 0\n    }\n  }\n\n  if (isOuter(element.styles.width)) {\n    if (element.parent && isAuto(element.parent.styles.width)) {\n      element.styles.width = CONSTANT.WIDTH.AUTO\n    }\n  }\n\n  if (isOuter(element.styles.height)) {\n    if (element.parent && isAuto(element.parent.styles.height)) {\n      element.styles.height = CONSTANT.WIDTH.AUTO\n    }\n  }\n}\n\nfunction _completeFont(element) {\n  if (element.styles.fontSize && !element.styles.lineHeight) {\n    element.styles.lineHeight = element.styles.fontSize * 1.4\n  }\n}\n\nfunction _completeFlex(element) {\n  if (\n    element.parent &&\n    element.parent.styles.display === CONSTANT.DISPLAY.FLEX\n  ) {\n    // flex布局内 width 和flex需要有一个\n    if (!element.styles.flex) {\n      if (!isExact(element.styles.height) && !isExact(element.styles.width)) {\n        element.styles.flex = 1\n      }\n    } else {\n      if (\n        element.parent.styles.flexDirection === 'column' &&\n        isExact(element.styles.flex)\n      ) {\n        element.styles.height = 0\n      } else if (\n        element.parent.styles.flexDirection === 'row' &&\n        isExact(element.styles.flex)\n      ) {\n        element.styles.width = 0\n      }\n    }\n  }\n}\n","import { isAuto } from '../utils'\nimport { CanvasElement } from './element'\n\nexport interface Line {\n  width: number\n  height: number\n  contentWidth: number // 右边界\n  x: number\n  y: number // 上\n  right: number\n  doorClosed: boolean // 是否允许加入\n  outerWidth: number\n  container: CanvasElement | null\n  elements: CanvasElement[]\n  start: CanvasElement | null // 起点，行最左边第一个\n  end: CanvasElement | null // 结束\n  offsetX: number\n  id: number\n  _initHeight(el: CanvasElement): void\n  _initLayout(el: CanvasElement): void\n  _getOffsetY(el: CanvasElement): number\n  _refreshWidthHeight(el: CanvasElement): void\n  _closeLine(): void\n  _getPrevLine(el: CanvasElement): { x: number; y: number }\n  _refreshXAlign(): void\n  bindElement(el: CanvasElement): void\n  refreshElementPosition(el: CanvasElement): void\n  addElement(el: CanvasElement): void\n  canIEnter(el: CanvasElement): boolean\n}\n\nlet id = 0\n\nexport function createLine() {\n  let line: Line = {\n    width: 0,\n    height: 0,\n    contentWidth: 0, // 右边界\n    x: 0,\n    y: 0, // 上\n    right: 0,\n    doorClosed: false, // 是否允许加入\n    outerWidth: 0,\n    container: null,\n    elements: [] as CanvasElement[],\n    start: null, // 起点，行最左边第一个\n    end: null, // 结束\n    offsetX: 0,\n    id: ++id,\n\n    _initHeight(el) {\n      line.height =\n        (el.parent && el.parent.context.renderStyles.lineHeight) || 0\n    },\n\n    _initLayout(el) {\n      line.right = el.getContainerLayout().contentX || 0\n      line.x = el.getContainerLayout().contentX || 0\n      line.y = line._getPrevLine(el).y\n    },\n\n    _getOffsetY(el) {\n      if (el.renderStyles.verticalAlign === 'bottom') {\n        return line.height - el.renderStyles.height\n      } else if (el.renderStyles.verticalAlign === 'middle') {\n        return (line.height - el.renderStyles.height) / 2\n      } else {\n        return 0\n      }\n    },\n\n    _refreshWidthHeight(el) {\n      if (el.renderStyles.height > line.height) {\n        line.height = el.renderStyles.height\n      }\n\n      line.width += el.renderStyles.width\n    },\n\n    _closeLine() {\n      // new line\n      line.end = line.elements[line.elements.length - 1]\n      line._refreshXAlign()\n    },\n\n    _getPrevLine(el: CanvasElement) {\n      if (el.prev) {\n        const prevLine = el.prev.context.line\n        if (prevLine) {\n          return { y: prevLine.height + prevLine.y, x: prevLine.x }\n        } else {\n          const prevLayout = el.getPrevLayout()\n          return {\n            y: prevLayout.y + prevLayout.height,\n            x: prevLayout.x\n          }\n        }\n      } else {\n        return {\n          y: el.getContainerLayout().contentY,\n          x: el.getContainerLayout().contentX\n        }\n      }\n    },\n\n    _refreshXAlign() {\n      if (line.outerWidth > 5000) return\n      if (!line.end) return\n      if (!line.end.parent) return\n      let offsetX = line.outerWidth - line.width\n      if (line.end.parent.context.renderStyles.textAlign === 'center') {\n        offsetX = offsetX / 2\n      } else if (line.end.parent.context.renderStyles.textAlign === 'left') {\n        offsetX = 0\n      }\n      line.offsetX = offsetX\n    },\n\n    bindElement(el) {\n      line.container = el.parent?.context\n      line._initHeight(el)\n\n      line.outerWidth =\n        el.parent && isAuto(el.parent.context.styles.width)\n          ? Infinity\n          : el.parent?.context.renderStyles.contentWidth\n\n      line.start = el\n      line.addElement(el)\n    },\n\n    refreshElementPosition(el) {\n      if (line.start === el) {\n        line._initLayout(el)\n      }\n      // 刷新位置，首先以左边计算\n      el.x = line.right + line.offsetX\n      el.y = line.y + line._getOffsetY(el)\n      // + (line.height - el.renderStyles.height) / 2\n      line.right += el.renderStyles.width\n    },\n\n    addElement(el: CanvasElement) {\n      line.elements.push(el)\n      el.line = line\n      line._refreshWidthHeight(el)\n\n      if (!el.next || el.next.context.renderStyles.display !== 'inline-block') {\n        line._closeLine()\n      }\n    },\n\n    canIEnter(el: CanvasElement) {\n      if (el.renderStyles.width + line.width > line.outerWidth) {\n        line._closeLine()\n        return false\n      } else {\n        return true\n      }\n    }\n  }\n\n  return line\n}\n","import { CanvasElement } from './element'\nimport { isExact, isAuto } from '../utils'\nimport STYLE_CONSTANT from './styleConstant'\n\nconst KEY = {\n  [STYLE_CONSTANT.FLEX_DIRECTION.ROW]: {\n    width: 'width',\n    contentWidth: 'contentWidth',\n    x: 'x',\n    y: 'y',\n    contentX: 'contentX',\n    height: 'height',\n    contentHeight: 'contentHeight'\n  },\n  [STYLE_CONSTANT.FLEX_DIRECTION.COLUMN]: {\n    width: 'height',\n    contentWidth: 'contentHeight',\n    x: 'y',\n    y: 'x',\n    contentX: 'contentY',\n    height: 'width',\n    contentHeight: 'contentWidth'\n  }\n}\n\nexport interface FlexBox {\n  key: null | string\n  exactValue: number\n  flexTotal: number\n  _closeLine(): void\n  _initHeight(): void\n  _refreshWidthHeight(el: CanvasElement): void\n  _initLayout(el: CanvasElement): void\n  _refreshElementPosition(el: CanvasElement): void\n  _calcFlex(): void\n  _refreshXAlign(): void\n  _getOffsetY(el: CanvasElement): number\n  bindElement(el: CanvasElement): void\n  addElement(el: CanvasElement): void\n}\n\n// 目前flex是基于inline-block的简单实现，只支持row方向width + flex混用\nexport function createFlexBox(): FlexBox {\n  let flexBox: FlexBox = {\n    key: null,\n    exactValue: 0,\n    flexTotal: 0,\n    _closeLine() {\n      super.closeLine()\n      this.calcFlex()\n    },\n\n    _initHeight() {\n      this[this.key.height] = 0\n    },\n\n    _refreshWidthHeight(el) {\n      if (el.renderStyles[this.key.height] > this[this.key.height]) {\n        this[this.key.height] = el.renderStyles[this.key.height]\n      }\n\n      this[this.key.width] += el.renderStyles[this.key.width]\n    },\n\n    _initLayout(el) {\n      this.right = el.getContainerLayout()[this.key.contentX]\n      this[this.key.x] = el.getContainerLayout()[this.key.contentX]\n      this[this.key.y] = this.getPreLine(el)[this.key.y]\n    },\n\n    _refreshElementPosition(el) {\n      if (this.start === el) {\n        this.initLayout(el)\n      }\n      // 刷新位置，首先以左边计算\n      el[this.key.x] = this.right + this.offsetX\n      el[this.key.y] = this[this.key.y] + this.getOffsetY(el)\n      // + (this.height - el.renderStyles.height) / 2\n      this.right += el.renderStyles[this.key.width]\n    },\n\n    _calcFlex() {\n      const { [this.key.contentWidth]: containerWidth } =\n        this.container.renderStyles\n      this.elements.forEach((child) => {\n        if (isExact(child.styles.flex)) {\n          child.renderStyles[this.key.width] =\n            (child.styles.flex / this.flexTotal) *\n            (containerWidth - this.exactValue)\n          child._refreshContentWithLayout()\n        }\n      })\n    },\n\n    _refreshXAlign() {\n      if (!this.end.parent) return\n      let offsetX = this.outerWidth - this[this.key.width]\n      if (this.end.parent.renderStyles.justifyContent === 'center') {\n        offsetX = offsetX / 2\n      } else if (this.end.parent.renderStyles.justifyContent === 'flex-start') {\n        offsetX = 0\n      }\n      this.offsetX = offsetX\n    },\n\n    _getOffsetY(el) {\n      if (el.renderStyles.alignSelf === 'flex-end') {\n        return (\n          this.container.renderStyles[this.key.contentHeight] -\n          el.renderStyles[this.key.height]\n        )\n      } else if (el.renderStyles.alignSelf === 'center') {\n        return (\n          (this.container.renderStyles[this.key.contentHeight] -\n            el.renderStyles[this.key.height]) /\n          2\n        )\n      } else {\n        return 0\n      }\n    },\n\n    bindElement(el) {\n      this.container = el.parent\n      if (el.parent) {\n        this.key = KEY[el.parent.context.renderStyles.flexDirection]\n      }\n      this.initHeight(el)\n      this.outerWidth =\n        el.parent && isAuto(el.parent.context.styles[this.key.width])\n          ? Infinity\n          : el.parent?.context.renderStyles[this.key.contentWidth]\n      this.start = el\n      this.add(el)\n    },\n\n    addElement(el) {\n      if (isExact(el.styles[this.key.width])) {\n        this.exactValue += el.renderStyles[this.key.width]\n      } else if (isExact(el.styles.flex)) {\n        this.flexTotal += el.renderStyles.flex\n      }\n\n      this.elements.push(el)\n      el.line = this\n      this.refreshWidthHeight(el)\n\n      if (!el.next) {\n        this.closeLine()\n      }\n    }\n  }\n\n  return flexBox\n}\n","import STYLE_CONSTANT, { ElementStyleType } from './styleConstant'\nimport { TreeNode, createTreeNode } from './treeNode'\nimport { Layer } from './layer'\nimport completeStyles from './completeStyles'\nimport {\n  isAuto,\n  isOuter,\n  isExact,\n  parseOuter,\n  findRelativeTo,\n  floor,\n  isArray\n} from '../utils'\nimport { Line, createLine } from './line'\nimport { createFlexBox } from './flexBox'\nimport { createViewElement } from './view'\nimport { createTextElement } from './text'\n\nexport const DEFAULT_CONTAINER = {\n  renderStyles: {\n    width: '100%',\n    height: '100%',\n    paddingTop: 0,\n    paddingBottom: 0,\n    paddingLeft: 0,\n    paddingRight: 0,\n    marginLeft: 0,\n    marginRight: 0,\n    marginTop: 0,\n    marginBottom: 0,\n    contentWidth: 0,\n    contentHeight: 0,\n    lineCap: 'butt',\n    visible: true\n  },\n  layout: {\n    x: 0,\n    y: 0,\n    contentX: 0,\n    contentY: 0\n  }\n}\n\n// export enum ElementTypes {\n//   root = 'root',\n//   view = 'view',\n//   text = 'text',\n//   img = 'img'\n// }\n\nexport type Layout = {\n  width: number\n  height: number\n  x: number\n  y: number\n  paddingTop?: number\n  paddingBottom?: number\n  paddingLeft?: number\n  paddingRight?: number\n  marginLeft?: number\n  marginRight?: number\n  marginTop?: number\n  marginBottom?: number\n  contentX?: number\n  contentY?: number\n  contentWidth?: number\n  contentHeight?: number\n}\n\ntype ExtendStyles = {\n  textAlign?: string\n  lineHeight?: number\n  fontSize?: number\n  color?: string\n  fontFamily?: string\n  alignItems?: string\n  alignSelf?: string\n  visible?: boolean\n}\n\ntype RenderStyle = {\n  width: number | string\n  height: number | string\n  paddingTop: number\n  paddingBottom: number\n  paddingLeft: number\n  paddingRight: number\n  marginLeft: number\n  marginRight: number\n  marginTop: number\n  marginBottom: number\n  contentWidth: number | string\n  contentHeight: number | string\n  lineCap: string // butt round square\n}\n\ntype CanvasElementContainer =\n  | {\n      renderStyles: RenderStyle\n      layout: Layout\n    }\n  | CanvasElement\n\nexport type ElementOptions = {\n  style?: ElementStyleType\n  text?: string\n}\n\nexport function isCanvasElement(value: any): value is CanvasElement {\n  return value ? value.__v_isElement === true : false\n}\n\nexport interface CanvasElement extends TreeNode {\n  __v_isElement: boolean\n  type: string\n  options: ElementOptions\n  styles: ElementStyleType\n  renderStyles: any\n  debugColor: string | null\n  container: CanvasElementContainer\n  root: CanvasElement | null\n  layer: Layer | null\n  relativeTo: CanvasElement | null\n  line: Line | null\n  layout: Layout\n  left: number\n  top: number\n  height: number\n  width: number\n  visible: boolean\n  _initStyles(): void\n  _getExtendStyles(): ExtendStyles\n  _getDefaultStyles(): ElementStyleType\n  _completeStyles(): void\n  _getChildren(): CanvasElement[]\n  _getChildrenInFlow(): CanvasElement[]\n  _reflow(): void\n  _initWidthHeight(): void\n  _initPosition(): void\n  _InFlexBox(): boolean\n  _refreshLayoutWithContent(): void\n  _refreshContentWithLayout(): void\n  _bindLine(): void\n  _bindFlexBox(): void\n  _measureLayout(): void\n  init(): void\n  appendChild(element: CanvasElement): void\n  getContainer(): CanvasElement\n  getContainerLayout(): Layout\n  getPrevLayout(): Layout\n  isInFlow(): boolean\n  isVisible(): boolean\n  paint(lastPaintTime: number): void\n  __proto__: any\n}\n\nexport function createElementAPI(layer: Layer) {\n  return function createElement(\n    type: string,\n    options: ElementOptions = {},\n    children?: CanvasElement[] | string\n  ): CanvasElement {\n    function _initStyles() {\n      console.log('[_initStyles-000000]', this)\n      element.styles = Object.assign(\n        {},\n        element._getDefaultStyles(),\n        element._getExtendStyles(),\n        element.options.style || {}\n      )\n\n      element._completeStyles()\n\n      element.renderStyles = _getRenderStyles(element)\n      console.log('_initStyles', element, element.renderStyles)\n\n      if (element._InFlexBox()) {\n        element._bindFlexBox()\n      } else if (!element.isInFlow()) {\n        element.relativeTo = findRelativeTo(element)\n      }\n    }\n\n    function _getRenderStyles(element) {\n      let renderStyles = { ...element.styles }\n      const parentWidth = element.getContainerLayout().contentWidth\n      const parentHeight = element.getContainerLayout().contentHeight\n      console.log(parentWidth, parentHeight)\n\n      if (isAuto(renderStyles.width)) {\n        renderStyles.paddingWidth = 0\n      } else if (isOuter(renderStyles.width)) {\n        renderStyles.paddingWidth =\n          parseOuter(renderStyles.width) * parentWidth -\n          renderStyles.marginLeft -\n          renderStyles.marginRight\n      } else {\n        renderStyles.paddingWidth = renderStyles.width\n      }\n\n      if (isAuto(renderStyles.height)) {\n        renderStyles.paddingHeight = 0\n      } else if (isOuter(renderStyles.height)) {\n        renderStyles.paddingHeight =\n          parseOuter(renderStyles.height) * parentHeight -\n          renderStyles.marginTop -\n          renderStyles.marginBottom\n      } else {\n        renderStyles.paddingHeight = renderStyles.height\n      }\n\n      if (!renderStyles.paddingWidth) renderStyles.paddingWidth = 0\n      if (!renderStyles.paddingHeight) renderStyles.paddingHeight = 0\n\n      // 初始化contentWidth\n      renderStyles.contentWidth =\n        renderStyles.paddingWidth -\n        renderStyles.paddingLeft -\n        renderStyles.paddingRight\n      renderStyles.contentHeight =\n        renderStyles.paddingHeight -\n        renderStyles.paddingTop -\n        renderStyles.paddingBottom\n\n      renderStyles.width =\n        renderStyles.paddingWidth +\n        renderStyles.marginLeft +\n        renderStyles.marginRight +\n        getTotalBorderWidth(renderStyles)\n      renderStyles.height =\n        renderStyles.paddingHeight +\n        renderStyles.marginTop +\n        renderStyles.marginBottom +\n        getTotalBorderHeight(renderStyles)\n\n      return renderStyles\n    }\n\n    function _getExtendStyles(): ExtendStyles {\n      let extendStyles = {} as ExtendStyles\n      const extendKeys = [\n        'textAlign',\n        'fontSize',\n        'color',\n        'fontFamily',\n        'alignItems',\n        'visible'\n      ]\n\n      console.log('_getExtendStyles', element, element.getContainer())\n\n      extendKeys.map((key) => {\n        const value = element.container.renderStyles[key]\n        if (value) extendStyles[key] = value\n        if (key === 'visible') extendStyles[key] = value\n      })\n\n      return extendStyles\n    }\n\n    function _getDefaultStyles() {\n      return STYLE_CONSTANT.DEFAULT_STYLES\n    }\n\n    function _completeStyles() {\n      completeStyles(element)\n    }\n\n    function _getChildren() {\n      return isArray(this.children) ? this.children : []\n    }\n\n    // 获取文档流中的子节点\n    function _getChildrenInFlow() {\n      return element._getChildren().filter((item) => item.isInFlow())\n    }\n\n    /**\n     * 实现文档流 需要知道上一个兄弟节点\n     */\n    function _reflow() {}\n\n    function _initWidthHeight() {\n      const {\n        width,\n        height,\n        display,\n        flex,\n        marginLeft,\n        marginRight,\n        marginTop,\n        marginBottom\n      } = element.styles\n      if (isAuto(width) || isAuto(height)) {\n        // 这一步需要遍历，判断一下\n        const layout = element._measureLayout()\n        // 初始化宽度高度\n        if (isAuto(width)) {\n          element.renderStyles.contentWidth = floor(layout.width)\n        }\n\n        if (isAuto(height)) {\n          // 不填就是auto\n          element.renderStyles.contentHeight = floor(layout.height)\n        }\n      }\n\n      element._refreshLayoutWithContent()\n\n      if (element._InFlexBox()) {\n        element.line.refreshWidthHeight(element)\n      } else if (display === STYLE_CONSTANT.DISPLAY.INLINE_BLOCK) {\n        // 如果是inline-block  这里仅计算高度\n        element._bindLine()\n      }\n    }\n\n    function _initPosition() {\n      let { contentX } = element.getContainerLayout()\n      const {\n        paddingLeft,\n        paddingTop,\n        borderLeftWidth,\n        borderTopWidth,\n        marginLeft,\n        marginTop\n      } = element.renderStyles\n      // 初始化ctx位置\n      if (!element.isInFlow()) {\n        // 不在文档流中\n        let { contentX, contentY, contentWidth, contentHeight } =\n          element.getContainerLayout(element.relativeTo)\n        let { top, bottom, right, left, width, height } = element.renderStyles\n        if (isOuter(top)) top = parseOuter(top) * contentHeight\n        if (isOuter(bottom)) bottom = parseOuter(bottom) * contentHeight\n        if (isOuter(left)) left = parseOuter(left) * contentWidth\n        if (isOuter(right)) right = parseOuter(right) * contentWidth\n        if (isExact(top)) {\n          element.y = contentY + top\n        } else if (isExact(bottom)) {\n          element.y = contentY + contentHeight - bottom - height\n        }\n\n        if (isExact(left)) {\n          element.x = contentX + left\n        } else if (isExact(right)) {\n          element.x = contentX + contentWidth - right - width\n        }\n      } else if (element._InFlexBox()) {\n        element.line.refreshElementPosition(element)\n      } else if (\n        element.renderStyles.display === STYLE_CONSTANT.DISPLAY.INLINE_BLOCK\n      ) {\n        // inline-block到line里计算\n        // element._bindLine()\n        element.line.refreshElementPosition(element)\n      } else {\n        element.x = contentX\n        element.y = element.getPrevLayout().y + element.getPrevLayout().height\n      }\n      element.x = floor(element.x)\n      element.y = floor(element.y)\n      element.contentX = element.x + paddingLeft + borderLeftWidth + marginLeft\n      element.contentY = element.y + paddingTop + borderTopWidth + marginTop\n    }\n\n    function _InFlexBox() {\n      if (!element.isInFlow()) return false\n      if (!element.container) return false\n      if (\n        element.container &&\n        element.container.renderStyles.display === STYLE_CONSTANT.DISPLAY.FLEX\n      )\n        return true\n    }\n\n    // 父元素根据子元素撑开content后，再计算width\n    function _refreshLayoutWithContent() {\n      element.renderStyles.height = floor(\n        element.renderStyles.contentHeight +\n          element.renderStyles.paddingTop +\n          element.renderStyles.paddingBottom +\n          element.renderStyles.marginTop +\n          element.renderStyles.marginBottom +\n          getTotalBorderHeight(element.renderStyles)\n      )\n      element.renderStyles.width = floor(\n        element.renderStyles.contentWidth +\n          element.renderStyles.paddingLeft +\n          element.renderStyles.paddingRight +\n          element.renderStyles.marginLeft +\n          element.renderStyles.marginRight +\n          getTotalBorderWidth(element.renderStyles)\n      )\n      element.renderStyles.paddingWidth = floor(\n        element.renderStyles.contentWidth +\n          element.renderStyles.paddingLeft +\n          element.renderStyles.paddingRight\n      )\n      element.renderStyles.paddingHeight = floor(\n        element.renderStyles.contentHeight +\n          element.renderStyles.paddingTop +\n          element.renderStyles.paddingBottom\n      )\n    }\n\n    // 父元素根据子元素撑开content后，再计算width\n    function _refreshContentWithLayout() {\n      element.renderStyles.contentHeight =\n        element.renderStyles.height -\n        element.renderStyles.paddingTop -\n        element.renderStyles.paddingBottom -\n        element.renderStyles.marginTop -\n        element.renderStyles.marginBottom -\n        getTotalBorderHeight(element.renderStyles)\n      element.renderStyles.contentWidth =\n        element.renderStyles.width -\n        element.renderStyles.paddingLeft -\n        element.renderStyles.paddingRight -\n        element.renderStyles.marginLeft -\n        element.renderStyles.marginRight -\n        getTotalBorderWidth(element.renderStyles)\n      element.renderStyles.paddingWidth = floor(\n        element.renderStyles.contentWidth +\n          element.renderStyles.paddingLeft +\n          element.renderStyles.paddingRight\n      )\n      element.renderStyles.paddingHeight = floor(\n        element.renderStyles.contentHeight +\n          element.renderStyles.paddingTop +\n          element.renderStyles.paddingBottom\n      )\n    }\n\n    function getTotalBorderWidth(renderStyles) {\n      return renderStyles.borderLeftWidth + renderStyles.borderRightWidth\n    }\n\n    function getTotalBorderHeight(renderStyles) {\n      return renderStyles.borderTopWidth + renderStyles.borderBottomWidth\n    }\n\n    function _bindLine() {\n      if (\n        element.prev &&\n        element.prev.line &&\n        element.prev.line.canIEnter(element)\n      ) {\n        element.prev.line.add(element)\n      } else {\n        // 新行\n        createLine().bindElement(element)\n        // new Line().bind(element)\n      }\n    }\n\n    function _bindFlexBox() {\n      if (element.pre && element.pre.line) {\n        element.pre.line.add(element)\n      } else {\n        // 新行\n        createFlexBox().bindElement(element)\n      }\n    }\n\n    // 计算自身的高度\n    function _measureLayout() {\n      let width = 0 // 需要考虑原本的宽度\n      let height = 0\n      element._getChildrenInFlow().forEach((child) => {\n        if (child.line) {\n          if (child.line.start === child) {\n            if (child.line.width > width) {\n              width = child.line.width\n            }\n            height += child.line.height\n          }\n        } else if (child.renderStyles.width > width) {\n          width = child.renderStyles.width\n          height += child.renderStyles.height\n        } else {\n          height += child.renderStyles.height\n        }\n      })\n\n      return { width, height }\n    }\n\n    function init() {\n      element._initStyles()\n    }\n\n    function appendChild(child) {\n      console.log('appendChild')\n      treeNode.appendChild.call(this, child)\n      element.layer.onElementAdd(child)\n    }\n\n    function getContainer() {\n      return treeNode.parent || DEFAULT_CONTAINER\n    }\n\n    function getContainerLayout(): Layout {\n      const container = element.container\n\n      return {\n        width: container.renderStyles.width,\n        height: container.renderStyles.height,\n        paddingTop: container.renderStyles.paddingTop,\n        paddingBottom: container.renderStyles.paddingBottom,\n        paddingLeft: container.renderStyles.paddingLeft,\n        paddingRight: container.renderStyles.paddingRight,\n        marginLeft: container.renderStyles.marginLeft,\n        marginRight: container.renderStyles.marginRight,\n        marginTop: container.renderStyles.marginTop,\n        marginBottom: container.renderStyles.marginBottom,\n        x: container.layout.x,\n        y: container.layout.y,\n        contentX: container.layout.contentX,\n        contentY: container.layout.contentY,\n        contentWidth: container.layout.contentWidth,\n        contentHeight: container.layout.contentHeight\n      }\n    }\n\n    // 这里前一个节点必须在文档流中\n    function getPrevLayout(): Layout {\n      let cur = element.prev\n      while (cur && !cur.isInFlow()) {\n        cur = cur.prev\n      }\n      // 如果没有前一个或者前面的都不在文档流中，获取容器的\n      if (cur) {\n        return {\n          width: cur.renderStyles.width,\n          height: cur.renderStyles.height,\n          x: cur.x,\n          y: cur.y\n        }\n      } else {\n        return {\n          width: 0,\n          height: 0,\n          x: element.getContainerLayout().contentX,\n          y: element.getContainerLayout().contentY\n        }\n      }\n    }\n\n    // 是否在文档流中\n    function isInFlow() {\n      const { position, display } = element.styles\n      return (\n        position !== STYLE_CONSTANT.POSITION.ABSOLUTE &&\n        position !== STYLE_CONSTANT.POSITION.FIXED\n      )\n    }\n\n    function isVisible() {\n      return element.renderStyles.visible && element.visible\n    }\n\n    function getLayer() {\n      return this.layer\n    }\n\n    function getRenderer() {\n      return this.layer.renderer\n    }\n\n    function paint(lastPaintTime) {}\n\n    const treeNode = createTreeNode(children)\n\n    const element: CanvasElement = {\n      __v_isElement: true,\n      type,\n      options,\n      styles: {} as ElementStyleType,\n      renderStyles: {},\n      debugColor: null,\n      x: 0,\n      y: 0,\n      contentX: 0,\n      contentY: 0,\n      left: 0,\n      top: 0,\n      height: 0,\n      width: 0,\n      visible: true,\n      layer,\n      relativeTo: null,\n      layout: { x: 0, y: 0, contentX: 0, contentY: 0, width: 0, height: 0 },\n      treeNode,\n      // __proto__: treeNode,\n      get container() {\n        console.log('1219219209100', treeNode.parent, treeNode)\n        return (\n          (treeNode.parent as CanvasElement) || {\n            ...DEFAULT_CONTAINER,\n            ...{\n              layout: {\n                contentWidth: layer.options.width,\n                contentHeight: layer.options.height\n              }\n            }\n          }\n        )\n      },\n      _initStyles,\n      _getExtendStyles,\n      _getDefaultStyles,\n      _completeStyles,\n      _getChildren,\n      _getChildrenInFlow,\n      _reflow,\n      _initWidthHeight,\n      _initPosition,\n      _InFlexBox,\n      _refreshLayoutWithContent,\n      _refreshContentWithLayout,\n      _bindLine,\n      _bindFlexBox,\n      _measureLayout,\n      init,\n      appendChild,\n      getContainer,\n      getContainerLayout,\n      getPrevLayout,\n      isInFlow,\n      isVisible,\n      getLayer,\n      getRenderer,\n      paint\n    }\n\n    // Object.assign(element, Object.create(treeNode))\n    // Object.setPrototypeOf(element, treeNode)\n    element.__proto__ = Object.create(treeNode.__proto__)\n    element.root = layer.node\n\n    switch (element.type) {\n      case 'text':\n        return createTextElement(element)\n      default:\n        return createViewElement(element)\n    }\n  }\n}\n","import { isAuto, isExact } from '../utils'\nimport { CanvasElement } from './element'\nimport { CanvasRenderer } from './renderer'\nimport STYLE_CONSTANT, { ElementStyleType } from './styleConstant'\n\ntype TextOptions = {}\n\ntype Layout = {}\n\ntype TextLine = {\n  text: string\n  layout: Layout\n}\n\nexport interface TextElement extends CanvasElement {\n  layout: any\n  lines: TextLine[]\n  children: string\n  debugColor: string\n\n  _getDefaultStyles(): ElementStyleType\n  _measureLayout(): Layout\n  _getFont(): string\n  _calcLine(): void\n  paint(): void\n}\n\nexport function createTextElement(element: CanvasElement): TextElement {\n  let text: TextElement = {\n    ...element,\n    layout: null,\n    lines: [] as TextLine[],\n    debugColor: 'blue',\n\n    _getDefaultStyles() {\n      return {\n        ...STYLE_CONSTANT.DEFAULT_STYLES,\n        display: STYLE_CONSTANT.DISPLAY.INLINE_BLOCK,\n        width: STYLE_CONSTANT.WIDTH.AUTO,\n        textAlign: 'left'\n      }\n    },\n\n    _measureLayout() {\n      console.log('_measureLayout', text)\n      text.layout = text.getRenderer().measureText(text, text.children)\n      text.layout.height = text.renderStyles.lineHeight\n      text._calcLine()\n      return text.layout\n    },\n\n    _getFont() {\n      const { fontSize, fontWeight, fontFamily } = text.renderStyles\n      return `${fontWeight} ${fontSize}px ${fontFamily}`\n    },\n\n    _calcLine() {\n      console.log('_calcLine', text.parent)\n      if (!text.parent || !text.children) return\n\n      const { width: textWidth, height: textHeight } = text.layout\n      let { contentWidth: parentContentWidth } = text.parent.renderStyles\n      const { width: parentWidth } = text.parent.styles\n      if (!isAuto(text.styles.width))\n        parentContentWidth = text.renderStyles.width\n      // 如果一行宽度够，或者父级宽度是auto\n      if (\n        (isExact(parentContentWidth) && parentContentWidth >= textWidth) ||\n        parentWidth === STYLE_CONSTANT.WIDTH.AUTO\n      ) {\n        text.lines = [\n          {\n            text: text.children,\n            layout: text.layout\n          }\n        ]\n      } else {\n        text.lines = []\n        let lineIndex = 1\n        let lineText = ''\n        let layout = null\n        let lastLayout = null\n        for (let i = 0; i < text.children.length; i++) {\n          layout = text\n            .getRenderer()\n            .measureText(text, lineText + text.children[i])\n          if (layout && layout.width > parentContentWidth) {\n            if (lineIndex >= text.renderStyles.maxLine) {\n              // 最大行数限制 以及maxline省略号实现\n              lineText = lineText.substring(0, lineText.length - 2) + '...'\n              break\n            }\n            // 超出了\n            text.lines.push({\n              text: lineText,\n              layout: lastLayout || layout\n            })\n            lineText = ''\n            lineIndex += 1\n          }\n\n          lineText += text.children[i]\n\n          lastLayout = layout\n        }\n        text.layout.width = parentContentWidth\n        text.lines.push({\n          text: lineText,\n          layout: text.getRenderer().measureText(text, lineText)\n        })\n        // 根据lineheihgt更新height\n        text.layout.height = text.lines.length * text.renderStyles.lineHeight\n      }\n    },\n\n    paint() {\n      const renderer = this.getRenderer()\n      renderer._drawBackground(text)\n      renderer._drawText(text)\n      renderer._drawBox(text)\n    }\n  }\n\n  return text\n}\n","import { CanvasElement } from './element'\n\ninterface ViewElement extends CanvasElement {\n  paint(): void\n}\n\nexport function createViewElement(element: CanvasElement): ViewElement {\n  return {\n    ...element,\n    paint() {\n      const renderer = this.getRenderer()\n\n      if (this.options.render) {\n        this.options.render(renderer.getCtx(), renderer.getCanvas(), this)\n      } else {\n        renderer._drawBackground(this)\n        renderer._drawBox(this)\n      }\n    }\n  }\n}\n","import { TreeNode } from '../Canvas/treeNode'\nimport { CanvasElement } from '../canvas/element'\nimport { TravedElementList } from '../canvas/layer'\nimport { isArray } from './general'\n\ntype Queue<T> = T[]\n\ntype TraversalFn = (node: TreeNode | CanvasElement) => TravedElementList\n\nexport const deepTraversal: TraversalFn = (node) => {\n  const nodes = <any>[]\n\n  if (node != null) {\n    const queue: Queue<TreeNode | CanvasElement> = []\n    let item\n    let children\n    queue.unshift(node)\n\n    while (queue.length != 0) {\n      item = queue.shift()\n      nodes.push(item)\n\n      children = item.children\n      if (isArray(children)) {\n        for (let i = children.length - 1; i >= 0; i--) queue.push(children[i])\n      }\n    }\n  }\n  return nodes\n}\n\nexport const wideTraversal: TraversalFn = (node) => {\n  const nodes = <any>[]\n\n  if (node != null) {\n    const queue: Queue<TreeNode | CanvasElement> = []\n    let item\n    let children\n\n    queue.unshift(node)\n\n    while (queue.length != 0) {\n      item = queue.shift()\n      nodes.push(item)\n\n      children = item.children\n      if (isArray(children)) {\n        for (let i = 0; i < children.length; i++) queue.push(children[i])\n      }\n    }\n  }\n\n  return nodes\n}\n","import { floor, getThrottle, isExact, isString, isWX, walk } from '../utils'\nimport { CanvasElement, isCanvasElement } from './element'\nimport { Layer } from './layer'\nimport STYLE_CONSTANT from './styleConstant'\nimport { isEndNode } from './treeNode'\nimport { getImage } from './weapp-adapter'\n\nfunction getBorderRadius(element: CanvasElement) {\n  const { paddingWidth, paddingHeight } = element.renderStyles\n  let { borderRadius } = element.renderStyles\n  if (borderRadius * 2 > paddingWidth) {\n    // 如果大于一半，则角不是90度，统一限制最大为一半\n    borderRadius = paddingWidth / 2\n  }\n  if (borderRadius * 2 > paddingHeight) {\n    borderRadius = paddingHeight / 2\n  }\n  if (borderRadius < 0) borderRadius = 0\n  return floor(borderRadius)\n}\n\nexport interface CanvasRenderer {\n  layer: Layer\n  imageBus: Object\n  isAnimate: boolean\n  lastPaintTime: number\n  lastFrameComplete: boolean\n  throttle: (fn: number) => void\n\n  _restore(fn: any): void\n  _path(fn: any): void\n  _helpParentRestoreCtx(el: CanvasElement): void\n  _drawBox(el: CanvasElement): void\n  _drawBackground(el: CanvasElement): void\n  _clip(el: CanvasElement): void\n  _parseBackground(color: string, el: CanvasElement): void\n  _drawText(el: CanvasElement): void\n  _drawImage(el: CanvasElement): void\n  _drawScroll(el: CanvasElement): void\n  _animate(): void\n  isDebug(): boolean\n  getCtx(): CanvasRenderingContext2D\n  getLayer(): Layer\n  paint(el: CanvasElement): void\n  afterPaint(el: CanvasElement): void\n  topBorder(x, y, borderRadius, w, h): void\n  rightBorder(x, y, borderRadius, w, h): void\n  bottomBorder(x, y, borderRadius, w, h): void\n  leftBorder(x, y, borderRadius, w, h): void\n  measureText(\n    el: CanvasElement,\n    text: string\n  ): { width: number; fontHeight: number }\n  getImageInstance(src: string): string[]\n  render(node: CanvasElement): void\n  renderFPS(): void\n  readyToRender(el: CanvasElement): void\n  requestRepaint(el: CanvasElement): void\n  getCanvas(): HTMLCanvasElement\n  stopAnimate(): void\n  onEffectFinished(): Promise<any[]>\n}\n\nexport function createCanvasRenderer(layer: Layer): CanvasRenderer {\n  let renderer: CanvasRenderer = {\n    layer: layer,\n    imageBus: {},\n    isAnimate: false,\n    lastPaintTime: 0,\n    lastFrameComplete: false,\n    throttle: getThrottle(16),\n\n    _restore(callback) {\n      this.getCtx().save()\n      callback()\n      this.getCtx().restore()\n    },\n\n    _path(callback) {\n      this.getCtx().beginPath()\n      callback()\n      this.getCtx().closePath()\n    },\n\n    _helpParentRestoreCtx(element) {\n      if (\n        (element.isVisible() && !isEndNode(element)) ||\n        (!element.isVisible() && element.next)\n      )\n        return\n      this.getCtx().restore()\n      let cur = element.parent\n      while (cur && !cur.next) {\n        // 如果父级也是同级最后一个，再闭合上一个\n        this.getCtx().restore()\n        cur = cur.parent\n      }\n    },\n\n    _drawBox(element) {\n      element.renderStyles = {\n        borderColor: 'red',\n        borderWidth: 4,\n        borderLeftWidth: 4,\n        borderRightWidth: 4,\n        borderTopWidth: 4,\n        borderBottomWidth: 4,\n        paddingLeft: 0,\n        paddingRight: 0,\n        paddingTop: 0,\n        paddingBottom: 0,\n        contentWidth: 100,\n        contentHeight: 100\n      }\n\n      if (\n        !(element.renderStyles.borderColor || element.renderStyles.shadowBlur)\n      )\n        return\n\n      const {\n        contentWidth,\n        contentHeight,\n        paddingLeft,\n        paddingTop,\n        borderStyle,\n        paddingRight,\n        paddingBottom,\n        borderLeftWidth,\n        borderRightWidth,\n        borderTopWidth,\n        borderBottomWidth,\n        borderWidth\n      } = element.renderStyles\n\n      let borderRadius = getBorderRadius(element)\n\n      // 这里是计算画border的位置，起点位置是在线条中间，所以要考虑线条宽度\n      let x =\n        element.contentX -\n        element.renderStyles.paddingLeft -\n        borderLeftWidth / 2\n      let y =\n        element.contentY - element.renderStyles.paddingTop - borderTopWidth / 2\n      let w =\n        contentWidth +\n        paddingLeft +\n        paddingRight +\n        (borderLeftWidth + borderRightWidth) / 2\n      let h =\n        contentHeight +\n        paddingTop +\n        paddingBottom +\n        (borderTopWidth + borderBottomWidth) / 2\n\n      this.getCtx().lineCap = element.renderStyles.lineCap || 'butt'\n      this.getCtx().strokeStyle = element.renderStyles.borderColor\n      this.getCtx().lineJoin = 'round'\n\n      // 实现虚线\n      if (borderStyle && borderStyle !== 'solid') {\n        if (Array.isArray(borderStyle)) {\n          this.getCtx().setLineDash(borderStyle)\n        } else {\n          this.getCtx().setLineDash([5, 5])\n        }\n      }\n\n      const stroke = (borderWidth) => {\n        // 有样式则绘制出来\n        this.getCtx().lineWidth = borderWidth\n        this.getCtx().stroke()\n      }\n      this._restore(() => {\n        this._path(() => {\n          if (element.renderStyles.borderTopWidth) {\n            this.topBorder({\n              x,\n              y,\n              borderRadius: borderRadius\n                ? borderRadius + element.renderStyles.borderTopWidth / 2\n                : 0,\n              w,\n              h\n            })\n            // 判断borderwidth 如果都是一样宽，只需要最后一次性绘制，提高性能\n            !borderWidth && stroke(element.renderStyles.borderTopWidth)\n          }\n          if (element.renderStyles.borderRightWidth) {\n            this.getCtx().moveTo(\n              x +\n                w -\n                borderRadius -\n                (borderRadius ? element.renderStyles.borderTopWidth / 2 : 0),\n              y\n            )\n            this.rightBorder({\n              x,\n              y,\n              borderRadius: borderRadius\n                ? borderRadius + element.renderStyles.borderRightWidth / 2\n                : 0,\n              w,\n              h\n            })\n            !borderWidth && stroke(element.renderStyles.borderRightWidth)\n          }\n          if (element.renderStyles.borderBottomWidth) {\n            this.getCtx().moveTo(\n              x + w,\n              y +\n                h -\n                borderRadius -\n                (borderRadius ? element.renderStyles.borderRightWidth / 2 : 0)\n            )\n            this.bottomBorder({\n              x,\n              y,\n              borderRadius: borderRadius\n                ? borderRadius + element.renderStyles.borderBottomWidth / 2\n                : 0,\n              w,\n              h\n            })\n            !borderWidth && stroke(element.renderStyles.borderBottomWidth)\n          }\n          if (element.renderStyles.borderLeftWidth) {\n            this.getCtx().moveTo(\n              x +\n                borderRadius +\n                (borderRadius ? element.renderStyles.borderBottomWidth / 2 : 0),\n              y + h\n            )\n            this.leftBorder({\n              x,\n              y,\n              borderRadius: borderRadius\n                ? borderRadius + element.renderStyles.borderLeftWidth / 2\n                : 0,\n              w,\n              h\n            })\n            stroke(element.renderStyles.borderLeftWidth)\n          }\n        })\n      })\n    },\n\n    _drawBackground(element) {\n      const {\n        backgroundColor,\n        contentWidth,\n        contentHeight,\n        shadowColor,\n        shadowBlur,\n        paddingLeft,\n        paddingRight,\n        paddingTop,\n        paddingBottom,\n        opacity,\n        shadowOffsetX,\n        shadowOffsetY,\n        borderLeftWidth,\n        borderRightWidth,\n        borderTopWidth,\n        borderBottomWidth\n      } = element.renderStyles\n      const ctx = this.getCtx()\n\n      let borderRadius = getBorderRadius(element)\n\n      // 这里是计算画border的位置，起点位置是在线条中间，所以要考虑线条宽度\n      let x =\n        element.contentX - element.renderStyles.paddingLeft - borderLeftWidth\n      let y =\n        element.contentY - element.renderStyles.paddingTop - borderTopWidth\n      let w =\n        contentWidth +\n        paddingLeft +\n        paddingRight +\n        (borderLeftWidth + borderRightWidth)\n      let h =\n        contentHeight +\n        paddingTop +\n        paddingBottom +\n        (borderTopWidth + borderBottomWidth)\n\n      if (isExact(opacity)) {\n        // 绘制透明图\n        ctx.globalAlpha = opacity\n      }\n\n      // 绘制boxshadow\n      // 需要在clip之前\n      if (shadowColor && shadowBlur) {\n        this._restore(() => {\n          this._path(() => {\n            this.topBorder({ x, y, borderRadius, w, h })\n            this.rightBorder({ x, y, borderRadius, w, h })\n            this.bottomBorder({ x, y, borderRadius, w, h })\n            this.leftBorder({ x, y, borderRadius, w, h })\n          })\n          if (isExact(shadowOffsetX)) {\n            this.getCtx().shadowOffsetX = shadowOffsetX\n          }\n          if (isExact(shadowOffsetY)) {\n            this.getCtx().shadowOffsetY = shadowOffsetY\n          }\n          this.getCtx().shadowBlur = shadowBlur\n          this.getCtx().shadowColor = shadowColor\n          this.getCtx().fillStyle = shadowColor\n          this.getCtx().fill()\n        })\n      }\n\n      this._clip(element)\n\n      // draw background\n      if (backgroundColor) {\n        this.getCtx().fillStyle = this._parseBackground(\n          backgroundColor,\n          element\n        )\n        this.getCtx().fillRect(\n          element.contentX - paddingLeft,\n          element.contentY - paddingTop,\n          contentWidth + paddingLeft + paddingRight,\n          contentHeight + paddingTop + paddingBottom\n        )\n      }\n\n      // for debug\n      if (this.isDebug()) {\n        this.getCtx().strokeStyle = element.debugColor || 'green'\n        this.getCtx().strokeRect(\n          element.contentX,\n          element.contentY,\n          element.renderStyles.contentWidth,\n          element.renderStyles.contentHeight\n        )\n        // ctx.strokeStyle = '#fff'\n        // ctx.strokeText(`${parseInt(this.contentX)} ${parseInt(this.contentY)} ${contentWidth} ${contentHeight}`, this.contentX + 100, this.contentY + 10)\n\n        //\n      }\n    },\n\n    _clip(element) {\n      if (element.renderStyles.overflow !== 'hidden') return\n      const {\n        contentWidth,\n        contentHeight,\n        paddingLeft,\n        paddingTop,\n        paddingRight,\n        paddingBottom,\n        borderLeftWidth,\n        borderRightWidth,\n        borderTopWidth,\n        borderBottomWidth\n      } = element.renderStyles\n\n      let borderRadius = getBorderRadius(element)\n\n      const borderBase = 0.7\n      // 为了把border也切进去\n      let x =\n        element.contentX -\n        element.renderStyles.paddingLeft -\n        borderLeftWidth * borderBase\n      let y =\n        element.contentY -\n        element.renderStyles.paddingTop -\n        borderTopWidth * borderBase\n      let w =\n        contentWidth +\n        paddingLeft +\n        paddingRight +\n        (borderLeftWidth + borderRightWidth) * borderBase\n      let h =\n        contentHeight +\n        paddingTop +\n        paddingBottom +\n        (borderTopWidth + borderBottomWidth) * borderBase\n\n      this._path(() => {\n        this.topBorder({ x, y, borderRadius, w, h })\n        this.rightBorder({ x, y, borderRadius, w, h })\n        this.bottomBorder({ x, y, borderRadius, w, h })\n        this.leftBorder({ x, y, borderRadius, w, h })\n      })\n\n      this.getCtx().clip()\n    },\n\n    _parseBackground(color, element) {\n      if (Array.isArray(color)) {\n        const gradient = this.getCtx().createLinearGradient(\n          element.contentX,\n          element.contentY,\n          element.contentX + element.renderStyles.contentWidth,\n          element.contentY + element.renderStyles.contentHeight\n        )\n        for (let i = 0; i < color.length; i++) {\n          if (i === 0) {\n            gradient.addColorStop(0, color[0])\n          } else {\n            gradient.addColorStop(i / (color.length - 1), color[i])\n          }\n        }\n        return gradient\n      } else {\n        return color\n      }\n    },\n\n    _drawText(element) {\n      const {\n        color,\n        contentWidth,\n        lineHeight,\n        textAlign,\n        textIndent,\n        textDecoration\n      } = element.renderStyles\n      let x = element.contentX\n      this.getCtx().fillStyle = color\n      this.getCtx().textAlign = textAlign\n      this.getCtx().font = element._getFont()\n      this.getCtx().textBaseline = 'middle'\n      if (textAlign === STYLE_CONSTANT.TEXT_ALIGN.RIGHT) {\n        x = element.contentX + contentWidth\n      } else if (textAlign === STYLE_CONSTANT.TEXT_ALIGN.CENTER) {\n        x = element.contentX + contentWidth / 2\n      }\n      let _x = x\n      let _y = 0\n      let line\n      for (let index = 0; index < element.lines.length; index++) {\n        line = element.lines[index]\n        if (index === 0 && textIndent) {\n          // 第一行实现textIndent\n          _x = x + textIndent\n        } else {\n          _x = x\n        }\n        _y = element.contentY + lineHeight / 2 + lineHeight * index + 0.5\n\n        this.getCtx().fillText(line.text, _x, _y)\n\n        if (isWX && element.renderStyles.fontWeight !== 400) {\n          // 小程序 字体加粗不生效\n          const offset = element.renderStyles.fontSize * 0.001\n          this.getCtx().fillText(line.text, _x - offset, _y)\n        }\n\n        // draw decoration\n        if (textDecoration) {\n          const decorationType = textDecoration[0]\n          _y += 1\n          this._restore(() => {\n            this._path(() => {\n              let decorationY = _y\n              if (decorationType === 'underline') {\n                decorationY = _y + element._layout.fontHeight / 2\n              } else if (decorationType === 'line-through') {\n                decorationY = _y\n              }\n              this.getCtx().moveTo(_x, decorationY)\n              this.getCtx().lineTo(_x + line.layout.width, decorationY)\n            })\n            this.getCtx().strokeStyle = color\n            this.getCtx().stroke()\n          })\n        }\n      }\n    },\n\n    _drawImage(element) {\n      if (!element._image) return\n      const { contentWidth, contentHeight } = element.renderStyles\n      const { mode } = element.options.attrs\n      const {\n        sx,\n        sy,\n        swidth,\n        sheight,\n        dx,\n        dy,\n        dwidth,\n        dheight,\n        width: imageW,\n        height: imageH\n      } = element._imageInfo\n      if (mode === 'aspectFill') {\n        this.getCtx().drawImage(\n          element._image,\n          sx,\n          sy,\n          swidth,\n          sheight,\n          element.contentX,\n          element.contentY,\n          contentWidth,\n          contentHeight\n        )\n      } else if (mode === 'aspectFit') {\n        this.getCtx().drawImage(\n          element._image,\n          0,\n          0,\n          imageW,\n          imageH,\n          dx,\n          dy,\n          dwidth,\n          dheight\n        )\n      } else {\n        this.getCtx().drawImage(\n          element._image,\n          element.contentX,\n          element.contentY,\n          contentWidth,\n          contentHeight\n        )\n      }\n    },\n\n    _drawScroll(element) {\n      this.getCtx().translate(element.currentScrollX, element.currentScrollY)\n    },\n\n    _animate() {\n      const now = Date.now()\n      this.render(this.element)\n      if (!this.isAnimate) return\n      window.requestAnimationFrame(() => this._animate(now))\n    },\n\n    isDebug() {\n      return this.getLayer().options && this.getLayer().options.debug\n    },\n\n    getCtx() {\n      return this.layer.ctx\n    },\n\n    getLayer() {\n      return this.layer\n    },\n\n    paint(element) {\n      this.getCtx().save()\n\n      element.paint(this.lastPaintTime)\n\n      this.afterPaint(element)\n    },\n\n    afterPaint(element) {\n      // 这里通过this.ctx栈实现了overflow\n      // 第一步判断没有子元素，绘制完成即restore 有子元素需要子元素全部绘制完毕再restore\n      if (!element.hasChildren() || element.type === 'text') {\n        this.getCtx().restore()\n      }\n\n      // 如果到了层级的最后一个 释放父级的stack\n      this._helpParentRestoreCtx(element)\n    },\n\n    topBorder({ x, y, borderRadius, w, h }) {\n      // 左上角开始\n      this.getCtx().moveTo(x, y + borderRadius)\n      borderRadius &&\n        this.getCtx().arc(\n          x + borderRadius,\n          y + borderRadius,\n          borderRadius,\n          2 * angle,\n          3 * angle\n        )\n      this.getCtx().lineTo(x + w - borderRadius, y)\n    },\n\n    rightBorder({ x, y, borderRadius, w, h }) {\n      // 右上角\n      // this.getCtx().moveTo(x + w - borderRadius, y)\n      borderRadius &&\n        this.getCtx().arc(\n          x + w - borderRadius,\n          y + borderRadius,\n          borderRadius,\n          3 * angle,\n          4 * angle\n        )\n      this.getCtx().lineTo(x + w, y + h - borderRadius)\n    },\n\n    bottomBorder({ x, y, borderRadius, w, h }) {\n      // 右下角\n      // this.getCtx().moveTo(x + w, y + h - borderRadius)\n      borderRadius &&\n        this.getCtx().arc(\n          x + w - borderRadius,\n          y + h - borderRadius,\n          borderRadius,\n          0,\n          angle\n        )\n      this.getCtx().lineTo(x + borderRadius, y + h)\n    },\n\n    leftBorder({ x, y, borderRadius, w, h }) {\n      // 左下角\n      borderRadius &&\n        this.getCtx().arc(\n          x + borderRadius,\n          y + h - borderRadius,\n          borderRadius,\n          angle,\n          angle * 2\n        )\n      this.getCtx().lineTo(x, y + borderRadius)\n    },\n\n    /**\n     * @param {String} text\n     * @return {Object<width,height>}\n     */\n    measureText(element, text) {\n      let w = 0\n      let h = 0\n      this._restore(() => {\n        this.getCtx().font = element._getFont()\n        const { width, actualBoundingBoxAscent } =\n          this.getCtx().measureText(text)\n        w = width\n        h = actualBoundingBoxAscent || element.renderStyles.fontSize * 0.7\n      })\n      return {\n        width: w,\n        fontHeight: h + 1\n      }\n    },\n\n    /**\n     * 这里应该保证onload src等接口\n     */\n    getImageInstance(src) {\n      let image = null\n\n      // 同样的路径返回缓存\n      if (this.imageBus[src]) {\n        image = this.imageBus[src]\n      } else {\n        if (isWX) {\n          if (this.getCanvas()) {\n            image = this.getCanvas().createImage()\n          } else {\n            console.warn('小程序请使用设置canvas参数以创建图片')\n            image = getImage(src)\n          }\n        } else {\n          image = new Image()\n          image.crossOrigin = 'anonymous'\n        }\n\n        if (src) {\n          this.imageBus[src] = new Promise((resolve, reject) => {\n            image.onload = (e) => {\n              resolve({\n                image: isWX && !this.getCanvas() ? e.image : image,\n                info: {\n                  width: isWX ? image.width : e.target.width,\n                  height: isWX ? image.height : e.target.height\n                }\n              })\n            }\n            image.onerror = (err) => {\n              reject(err)\n            }\n          })\n        }\n\n        image.src = src\n      }\n      return this.imageBus[src]\n    },\n\n    render(node) {\n      this.lastFrameComplete = false\n      this.lastPaintTime = Date.now()\n      if (!node.parent) {\n        // root\n        this.getCtx().clearRect(\n          0,\n          0,\n          this.getLayer().options.width,\n          this.getLayer().options.height\n        )\n      } else {\n        this.getCtx().clearRect(\n          node.x,\n          node.y,\n          node.renderStyles.width,\n          node.renderStyles.height\n        )\n      }\n      let element = null\n      walk(node, (renderNode, callContinue, callNext) => {\n        if (isCanvasElement(renderNode) && renderNode.isVisible()) {\n          // 可见的才渲染\n          this.paint(renderNode)\n        } else {\n          // 跳过整个子节点\n          callNext()\n          this._helpParentRestoreCtx(renderNode)\n        }\n      })\n      if (isWX) {\n        // 兼容小程序\n        this.getCtx().draw && this.getCtx().draw()\n      }\n\n      this.lastFrameComplete = true\n    },\n\n    renderFPS() {},\n\n    readyToRender(element) {\n      // this.element = generateRenderTree(element)\n      this.element = element\n\n      const options = this.getLayer().options\n\n      this.lastPaintTime = Date.now()\n\n      if (options && options.animate) {\n        this.animate()\n      } else {\n        this.render(element)\n      }\n    },\n\n    requestRepaint(element) {\n      if (this.isAnimate) return\n      // 如果已经有frame在排队等待了 忽略\n      // if(!this.lastFrameComplete) return\n      // let nextFrameTime = Date.now() - this.lastPaintTime\n      // if(nextFrameTime < 16){\n      //   setTimeout(() => this.render(this.element),nextFrameTime)\n      // }else{\n      this.render(this.element)\n      // }\n    },\n\n    // could be null\n    getCanvas() {\n      const options = this.getLayer().options\n      return (options && options.canvas) || null\n    },\n\n    stopAnimate() {\n      this.isAnimate = false\n    },\n\n    // 所有副作用完成\n    // 图片加载异步请求\n    onEffectFinished() {\n      const list = Object.keys(this.imageBus).map((key) => {\n        return this.imageBus[key]\n      })\n      return Promise.all(list)\n    }\n  }\n\n  return renderer\n}\n","export function getThrottle(threshold: number) {\n  let timer\n  return function (fn) {\n    if (!timer) {\n      timer = setTimeout(function () {\n        fn()\n        timer = null\n      }, threshold)\n    }\n  }\n}\n","// 只支持小程序最新的支持同层渲染的canvas api,\n// 不用了\nexport function getImage(url) {\n  const instance = { onload: () => {} }\n  new Promise((resolve, reject) => {\n    wx.downloadFile({\n      url: url,\n      success(res) {\n        wx.getImageInfo({\n          src: res.tempFilePath,\n          success(res1) {\n            resolve({\n              target: {\n                width: res1.width,\n                height: res1.height\n              },\n              image: res.tempFilePath\n            })\n          }\n        })\n      },\n      fail(err) {\n        reject(err)\n      }\n    })\n  })\n    .then((res) => {\n      instance.onload(res)\n    })\n    .catch((err) => {})\n  return instance\n}\n","import { createAppAPI } from './createApp'\nimport { createRenderer } from './renderer'\nimport { createNodeOps } from './nodeOps'\nimport { h } from './h'\nimport { createLayer } from './canvas'\n\nconst XCanvas = {\n  createNodeOps,\n  createRenderer,\n  h,\n  createLayer\n}\n\nexport default XCanvas\n","import { RendererOptions } from './renderer'\n\nexport function createNodeOps(createElement): RendererOptions {\n  return {\n    insert: (child, parent, anchor) => {\n      if (!child) {\n        return\n      }\n\n      parent.appendChild(child)\n    },\n\n    remove: (child) => {},\n\n    createElement: (tag, props) => {\n      props = props || {}\n      const { style } = props\n\n      switch (tag) {\n        default:\n          return createElement('view', { style })\n      }\n    },\n\n    createText: (text) => {\n      // console.log('createText', text)\n      return createElement('text', {}, text)\n    },\n\n    createComment: (text) => {},\n\n    setText: (node, text) => {},\n\n    setElementText: (el, text) => {},\n\n    parentNode: (node) => node.parentNode as Element | null,\n\n    nextSibling: (node) => node.nextSibling\n\n    //   querySelector: (selector) => {},\n  }\n}\n","import {\n  VNode,\n  VNodeProps,\n  VNodeArrayChildren,\n  isSameVNodeType,\n  normalizeVNode\n} from './vnode'\nimport { createAppAPI } from './createApp'\nimport { ComponentInternalInstance, Data } from './components'\nimport { flushPreFlushCbs, flushPostFlushCbs } from './scheduler'\nimport { EMPTY_OBJ, EMPTY_ARR, PatchFlags, ShapeFlags } from './utils'\n\nexport type RootRenderFunction<HostElement = RendererElement> = (\n  vnode: VNode | null,\n  container: HostElement,\n  isSVG?: boolean\n) => void\n\ntype MountChildrenFn = (\n  children: VNodeArrayChildren,\n  container: RendererElement,\n  anchor: RendererNode | null,\n  parentComponent: ComponentInternalInstance | null,\n  start?: number\n) => void\n\ntype NextFn = (vnode: VNode) => RendererNode | null\n\ntype RemoveFn = (vnode: VNode) => void\n\ntype UnmountChildrenFn = (\n  children: VNode[],\n  parentComponent: ComponentInternalInstance | null,\n  // parentSuspense: SuspenseBoundary | null,\n  doRemove?: boolean,\n  optimized?: boolean,\n  start?: number\n) => void\n\ntype ProcessTextOrCommentFn = (\n  n1: VNode | null,\n  n2: VNode,\n  container: RendererElement,\n  anchor: RendererNode | null\n) => void\n\nexport interface RendererOptions<\n  HostNode = RendererNode,\n  HostElement = RendererElement\n> {\n  patchProp(\n    el: HostElement,\n    key: string,\n    prevValue: any,\n    nextValue: any,\n    prevChildren?: VNode<HostNode, HostElement>[],\n    parentComponent?: ComponentInternalInstance | null,\n    unmountChildren?: UnmountChildrenFn\n  ): void\n  insert(el: HostNode, parent: HostElement, anchor?: HostNode | null): void\n  remove(el: HostNode): void\n  createElement(\n    type: string,\n    vnodeProps?: (VNodeProps & { [key: string]: any }) | null\n  ): HostElement\n  createText(text: string): HostNode\n  createComment(text: string): HostNode\n  setText(node: HostNode, text: string): void\n  setElementText(node: HostElement, text: string): void\n  parentNode(node: HostNode): HostElement | null\n  nextSibling(node: HostNode): HostNode | null\n  // querySelector?(selector: string): HostElement | null\n}\n\nexport interface RendererNode {\n  [key: string]: any\n}\n\nexport interface RendererElement extends RendererNode {}\n\ntype PatchFn = (\n  n1: VNode | null, // null means this is a mount\n  n2: VNode,\n  container: RendererElement,\n  anchor?: RendererNode | null,\n  parentComponent?: ComponentInternalInstance | null\n) => void\n\ntype PatchChildrenFn = (\n  n1: VNode | null,\n  n2: VNode,\n  container: RendererElement,\n  anchor: RendererNode | null,\n  parentComponent: ComponentInternalInstance | null\n) => void\n\ntype UnmountFn = (\n  vnode: VNode,\n  parentComponent: ComponentInternalInstance | null,\n  doRemove?: boolean,\n  optimized?: boolean\n) => void\n\nexport function createRenderer(options: RendererOptions): any {\n  const {\n    insert: hostInsert,\n    remove: hostRemove,\n    patchProp: hostPatchProp,\n    createElement: hostCreateElement,\n    createText: hostCreateText,\n    createComment: hostCreateComment,\n    setText: hostSetText,\n    setElementText: hostSetElementText,\n    parentNode: hostParentNode,\n    nextSibling: hostNextSibling\n  } = options\n\n  const patch: PatchFn = (\n    n1,\n    n2,\n    container,\n    anchor = null,\n    parentComponent = null\n  ) => {\n    // console.log('patch', n1, n2, container)\n    if (n1 === n2) {\n      return\n    }\n\n    // patching & not same type, unmount old tree\n    if (n1 && !isSameVNodeType(n1, n2)) {\n      anchor = getNextHostNode(n1)\n      unmount(n1, parentComponent, true)\n      n1 = null\n    }\n\n    const { type } = n2\n    switch (type) {\n      case 'Text':\n        processText(n1, n2, container, anchor)\n        break\n      // case 'Comment':\n      //   processCommentNode(n1, n2, container, anchor)\n      //   break\n      default:\n        processElement(n1, n2, container, anchor, parentComponent)\n    }\n  }\n\n  const processText: ProcessTextOrCommentFn = (n1, n2, container, anchor) => {\n    if (n1 == null) {\n      hostInsert(hostCreateText(n2.children as string), container, anchor)\n    } else {\n      if (n2.children !== n1.children) {\n        hostSetText(n2, n2.children as string)\n      }\n    }\n  }\n\n  const processElement = (\n    n1: VNode | null,\n    n2: VNode,\n    container: RendererElement,\n    anchor: RendererNode | null,\n    parentComponent: ComponentInternalInstance | null\n  ) => {\n    if (n1 == null) {\n      mountElement(n2, container, anchor, parentComponent)\n    } else {\n      patchElement(n1, n2, parentComponent)\n    }\n  }\n\n  const mountElement = (\n    vnode: VNode,\n    container: RendererElement,\n    anchor: RendererNode | null,\n    parentComponent: ComponentInternalInstance | null\n  ) => {\n    let el: RendererElement\n    const { type, props } = vnode\n    // console.log('mountElement', vnode, container, anchor, parentComponent)\n\n    el = vnode.el = hostCreateElement(vnode.type as string, props)\n\n    // mount children first, since some props may rely on child content\n    // being already rendered, e.g. `<select value>`\n\n    mountChildren(\n      vnode.children as VNodeArrayChildren,\n      el,\n      null,\n      parentComponent\n    )\n\n    // props\n    if (props) {\n      // for (const key in props) {\n      //   if (key !== 'value' && !isReservedProp(key)) {\n      //     hostPatchProp(\n      //       el,\n      //       key,\n      //       null,\n      //       props[key],\n      //       isSVG,\n      //       vnode.children as VNode[],\n      //       parentComponent,\n      //       parentSuspense,\n      //       unmountChildren\n      //     )\n      //   }\n      // }\n\n      if ('value' in props) {\n        // hostPatchProp(el, 'value', null, props.value)\n      }\n    }\n\n    hostInsert(el, container, anchor)\n  }\n\n  const mountChildren: MountChildrenFn = (\n    children,\n    container,\n    anchor,\n    parentComponent,\n    start = 0\n  ) => {\n    // console.log('mountChildren', children, container, anchor, parentComponent)\n    if (typeof children === 'string') {\n      patch(null, normalizeVNode(children), container, anchor, parentComponent)\n    } else {\n      for (let i = start; i < children.length; i++) {\n        const child = normalizeVNode(children[i])\n        patch(null, child, container, anchor, parentComponent)\n      }\n    }\n  }\n\n  const patchElement = (\n    n1: VNode,\n    n2: VNode,\n    parentComponent: ComponentInternalInstance | null\n  ) => {\n    const el = (n2.el = n1.el!)\n\n    const oldProps = n1.props || EMPTY_OBJ\n    const newProps = n2.props || EMPTY_OBJ\n\n    patchChildren(n1, n2, el, null, parentComponent)\n\n    // text\n    if (n1.children !== n2.children) {\n      hostSetElementText(el, n2.children as string)\n    }\n\n    patchProps(el, n2, oldProps, newProps, parentComponent)\n  }\n\n  const patchChildren: PatchChildrenFn = (\n    n1,\n    n2,\n    container,\n    anchor,\n    parentComponent\n  ) => {\n    const c1 = n1 && n1.children\n    const c2 = n2.children\n\n    patchUnkeyedChildren(\n      c1 as VNode[],\n      c2 as VNodeArrayChildren,\n      container,\n      anchor,\n      parentComponent\n    )\n  }\n\n  const patchUnkeyedChildren = (\n    c1: VNode[],\n    c2: VNodeArrayChildren,\n    container: RendererElement,\n    anchor: RendererNode | null,\n    parentComponent: ComponentInternalInstance | null\n  ) => {\n    c1 = c1 || EMPTY_ARR\n    c2 = c2 || EMPTY_ARR\n    const oldLength = c1.length\n    const newLength = c2.length\n    const commonLength = Math.min(oldLength, newLength)\n    let i\n    for (i = 0; i < commonLength; i++) {\n      const nextChild = normalizeVNode(c2[i])\n      patch(c1[i], nextChild, container, null, parentComponent)\n    }\n    if (oldLength > newLength) {\n      // remove old\n      unmountChildren(c1, parentComponent, true, false, commonLength)\n    } else {\n      // mount new\n      mountChildren(c2, container, anchor, parentComponent, commonLength)\n    }\n  }\n\n  const patchProps = (\n    el: RendererElement,\n    vnode: VNode,\n    oldProps: Data,\n    newProps: Data,\n    parentComponent: ComponentInternalInstance | null\n  ) => {\n    if (oldProps !== newProps) {\n      if (oldProps !== EMPTY_OBJ) {\n        for (const key in oldProps) {\n          hostPatchProp(\n            el,\n            key,\n            oldProps[key],\n            null,\n            vnode.children as VNode[],\n            parentComponent,\n            unmountChildren\n          )\n        }\n      }\n      for (const key in newProps) {\n        const next = newProps[key]\n        const prev = oldProps[key]\n        // defer patching value\n        if (next !== prev && key !== 'value') {\n          hostPatchProp(\n            el,\n            key,\n            prev,\n            next,\n            vnode.children as VNode[],\n            parentComponent,\n            unmountChildren\n          )\n        }\n      }\n      if ('value' in newProps) {\n        hostPatchProp(el, 'value', oldProps.value, newProps.value)\n      }\n    }\n  }\n\n  const unmount: UnmountFn = (\n    vnode,\n    parentComponent,\n    doRemove = false,\n    optimized = false\n  ) => {\n    const { type, props, children } = vnode\n\n    unmountChildren(children as VNode[], parentComponent)\n\n    if (doRemove) {\n      remove(vnode)\n    }\n  }\n\n  const remove: RemoveFn = (vnode) => {\n    const performRemove = () => {\n      hostRemove(vnode)\n    }\n\n    performRemove()\n  }\n\n  const unmountChildren: UnmountChildrenFn = (\n    children,\n    parentComponent,\n    doRemove = false,\n    optimized = false,\n    start = 0\n  ) => {\n    for (let i = start; i < children.length; i++) {\n      unmount(children[i], parentComponent, doRemove)\n    }\n  }\n\n  const getNextHostNode: NextFn = (vnode) => {\n    return hostNextSibling(vnode!)\n  }\n\n  const render: RootRenderFunction = (vnode, container) => {\n    // console.log('render:', vnode, container, container._vnode)\n\n    if (vnode == null) {\n      if (container._vnode) {\n        unmount(container._vnode, null, true)\n      }\n    } else {\n      patch(container._vnode || null, vnode, container, null, null)\n    }\n    flushPreFlushCbs()\n    flushPostFlushCbs()\n    container._vnode = vnode\n  }\n\n  return {\n    render,\n    createApp: createAppAPI(render)\n  }\n}\n","import { VNode, createVNode, VNodeArrayChildren, isVNode } from './vnode'\nimport { isObject, isArray } from './utils'\n\nexport function h(type: any, propsOrChildren?: any, children?: any): VNode {\n  const l = arguments.length\n  if (l === 2) {\n    if (isObject(propsOrChildren) && !isArray(propsOrChildren)) {\n      // single vnode without props\n      if (isVNode(propsOrChildren)) {\n        return createVNode(type, null, [propsOrChildren])\n      }\n      // props without children\n      return createVNode(type, propsOrChildren)\n    } else {\n      // omit props\n      return createVNode(type, null, propsOrChildren)\n    }\n  } else {\n    if (l > 3) {\n      children = Array.prototype.slice.call(arguments, 2)\n    } else if (l === 3 && isVNode(children)) {\n      children = [children]\n    }\n    return createVNode(type, propsOrChildren, children)\n  }\n}\n","import { TreeNode, connectChildren } from './treeNode'\nimport { CanvasElement, createElementAPI } from './element'\nimport { wideTraversal, deepTraversal } from '../utils/traversal'\nimport { CanvasRenderer, createCanvasRenderer } from './renderer'\nimport { isWX, walkParent } from '../utils'\n\nexport type TravedElementList = Array<CanvasElement>\n\ntype LayerOptions = {\n  dpr: number\n  width: number\n  height: number\n  renderStyles: any\n}\n\nexport interface Layer {\n  ctx: CanvasRenderingContext2D\n  node: CanvasElement | null\n  p2cList: TravedElementList\n  c2pList: TravedElementList\n  nodeList: TreeNode[]\n  options: LayerOptions\n  renderer: CanvasRenderer | null\n  _initRender(): void\n  _initC2PList(): void\n  _initP2CList(): void\n  _flow(): void\n  _reflow(): void\n  _initPaintList(): void\n  _reflowElement(elm: CanvasElement): void\n  _callBeforePaint(): void\n  _repaint(): void\n  init(): void\n  mount(elm: CanvasElement): void\n  update(ctx: CanvasRenderingContext2D, options: LayerOptions): void\n  onElementRemove(elm: CanvasElement): void\n  onElementAdd(elm: CanvasElement): void\n  onElementChange(elm: CanvasElement): void\n  animate(): void\n  getElementBy(): CanvasElement\n  lifecycle(name: string, arg: any): void\n}\n\nexport function createLayer(ctx, options) {\n  const layer: Layer = {\n    ctx,\n    node: null,\n    p2cList: [] as CanvasElement[],\n    c2pList: [] as CanvasElement[],\n    nodeList: [],\n    options: options,\n    renderer: null,\n\n    _initRender() {\n      // for 打印耗时\n      const startTime = Date.now()\n\n      connectChildren(layer.node)\n      layer._initC2PList()\n      layer._initP2CList()\n\n      layer._flow()\n\n      // flow 完成后监听effect完成\n      layer.renderer\n        .onEffectFinished()\n        .then((res) => layer.lifecycle('onEffectSuccess', res))\n        .catch((res) => layer.lifecycle('onEffectFail', res))\n      // .finally((res) => layer.lifecycle('onEffectFinished', res))\n\n      layer._repaint()\n\n      console.log(\n        `渲染${layer.p2cList.length}个元素 耗时 ${Date.now() - startTime} ms`\n      )\n    },\n\n    _initP2CList() {\n      if (layer.node) layer.p2cList = wideTraversal(layer.node)\n    },\n\n    _initC2PList() {\n      if (layer.node) layer.c2pList = deepTraversal(layer.node)\n    },\n\n    _flow() {\n      for (let i = 0; i < layer.p2cList.length; i++) {\n        layer.p2cList[i].init()\n      }\n\n      layer._reflow()\n    },\n\n    _reflow() {},\n\n    _initPaintList() {},\n\n    _reflowElement(elm) {\n      // 如果有line，则需要重第一个开始\n      let target: any = elm\n      while (target && target.line) {\n        target = target.parent\n      }\n      const p2cList = wideTraversal(target)\n      for (let i = 0; i < p2cList.length; i++) {\n        // p2cList[i]._initStyles()\n      }\n\n      // 所有子元素\n      const children = deepTraversal(target)\n      for (let i = 0; i < children.length; i++) {\n        children[i]._initWidthHeight()\n      }\n\n      if (!elm.isInFlow()) {\n        for (let i = 0; i < p2cList.length; i++) {\n          p2cList[i]._initPosition()\n        }\n        this._repaint()\n      } else {\n        this.onElementChange(target)\n      }\n    },\n\n    _callBeforePaint() {\n      for (let i = 0; i < layer.p2cList.length; i++) {\n        layer.p2cList[i].beforePaint && layer.p2cList[i].beforePaint()\n      }\n    },\n\n    /**\n     * 可以给定element，则只会重绘element所在的区域\n     * @param {Element} element\n     */\n    _repaint(elm = layer.node) {\n      if (isWX) {\n        // 微信环境下始终重绘整个树\n        elm = layer.node\n      }\n      if (elm && !elm.isInFlow()) elm = layer.node\n\n      layer._callBeforePaint()\n\n      if (layer.node && layer.renderer) {\n        layer.renderer.readyToRender(layer.node)\n      } else {\n        throw Error('repaint need node in layer')\n      }\n    },\n\n    update(ctx, options) {\n      layer.ctx = ctx\n      layer.options = options\n      layer.options.renderStyles = options\n      // if (layer.node) {\n      //   layer.node.container = layer.options\n      // }\n    },\n\n    init() {\n      layer.renderer = createCanvasRenderer(layer)\n      layer._initRender()\n    },\n\n    mount(elm) {\n      console.log('mount')\n      layer.node.appendChild(elm)\n    },\n\n    onElementRemove() {},\n\n    onElementAdd(elm) {\n      console.log('onElementAdd', elm)\n      layer._initC2PList()\n      layer._initP2CList()\n\n      console.log(layer.p2cList)\n\n      layer.p2cList.forEach((item) => {\n        console.log('onElementAdd-000000', item)\n        item.init()\n      })\n      // layer._reflowElement(el)\n    },\n\n    // 元素变化后调用，尽可能少重排重绘\n    onElementChange(elm) {\n      walkParent(elm, (parent, callbreak) => {\n        parent._initWidthHeight()\n        if (parent.type === 'scroll-view') callbreak()\n      })\n\n      for (let i = 0; i < layer.p2cList.length; i++) {\n        layer.p2cList[i]._initPosition()\n      }\n      layer._repaint()\n    },\n\n    animate() {\n      console.warn('use [animate] option instead!')\n    },\n\n    getElementBy() {\n      return layer.node.getElementBy(...arguments)\n    },\n\n    lifecycle(name, arg) {\n      if (layer.options.lifecycle) {\n        layer.options.lifecycle[name] && layer.options.lifecycle[name](arg)\n      }\n    }\n  }\n\n  const createCanvasElement = createElementAPI(layer)\n  const createRootCanvasElement = () => createCanvasElement('root', {}, [])\n\n  layer.node = createRootCanvasElement()\n  layer.node.layer = layer\n  layer.node.root = layer.node\n\n  layer.init()\n\n  return {\n    layer,\n    createCanvasElement,\n    createRootCanvasElement\n  }\n}\n"],"names":["EMPTY_OBJ","Object","freeze","EMPTY_ARR","onRE","isOn","key","test","isExact","num","isAuto","isOuter","match","parseOuter","_n","parseInt","replace","isNaN","isArray","Array","isFunction","val","isString","isObject","floor","walkParent","element","callback","cur","stop","callbreak","parent","isWX","Boolean","wx","getSystemInfoSync","err","normalizeStyle","value","res","i","length","item","normalized","parseStringStyle","listDelimiterRE","propertyDelimiterRE","styleCommentRE","cssText","ret","split","forEach","tmp","trim","normalizeClass","name_1","_a","Fragment","Symbol","for","Comment","isVNode","__v_isVNode","createVNode","type","props","children","patchFlag","cloned","cloneVNode","vnode","createTextVNode","normalizeChildren","klass","class","style","__v_skip","component","el","staticCount","appContext","ctx","createBaseVNode","extraProps","mergeRef","mergedProps","args","_i","arguments","toMerge","existing","incoming","includes","concat","mergeProps","map","deepCloneVNode","text","flag","normalizeVNode","child","slice","cloneIfMounted","String","uid","createAppAPI","render","rootComponent","rootProps","app","_uid","_component","_props","_container","_instance","mount","rootContainer","__assign","assign","t","s","n","p","prototype","hasOwnProperty","call","apply","this","queue","pendingPostFlushCbs","activePostFlushCbs","postFlushIndex","RECURSION_LIMIT","flushPostFlushCbs","seen","deduped","to","from","pack","ar","l","Set","push","Map","sort","a","b","getId","checkRecursiveUpdates","job","id","Infinity","fn","has","count","get","set","isTreeNode","__v_isTreeNode","connectChildren","hasChildren","filter","_getChildren","index","_setParent","_setSibling","DISPLAY","BLOCK","INLINE_BLOCK","INLINE","FLEX","NONE","WIDTH","AUTO","OUTER","FLEX_DIRECTION","ROW","COLUMN","STYLE_CONSTANT","POSITION","ABSOLUTE","FIXED","RELATIVE","STATIC","TEXT_ALIGN","LEFT","RIGHT","CENTER","DEFAULT_STYLES","display","fontSize","fontWeight","fontFamily","color","paddingTop","paddingBottom","paddingLeft","paddingRight","marginTop","marginBottom","marginLeft","marginRight","height","borderRadius","borderColor","lineCap","flexDirection","verticalAlign","textAlign","justifyContent","alignItems","alignSelf","whiteSpace","zIndex","visible","position","completeStyles","styles","CONSTANT","flex","width","_completeFlex","isInFlow","_completeWidth","borderWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopWidth","overflow","_completeBorder","lineHeight","_completeFont","padding","margin","_completePaddingMargin","KEY","contentWidth","x","y","contentX","contentHeight","DEFAULT_CONTAINER","renderStyles","layout","contentY","createElementAPI","layer","options","getTotalBorderWidth","getTotalBorderHeight","treeNode","_children","root","prev","next","node","console","log","appendChild","Error","prependChild","removeChild","append","prepend","remove","createTreeNode","__v_isElement","debugColor","left","top","relativeTo","container","_initStyles","_getDefaultStyles","_getExtendStyles","_completeStyles","parentWidth","getContainerLayout","parentHeight","paddingWidth","paddingHeight","_getRenderStyles","_InFlexBox","_bindFlexBox","findRelativeTo","extendStyles","getContainer","_getChildrenInFlow","_reflow","_initWidthHeight","_measureLayout","_refreshLayoutWithContent","line","refreshWidthHeight","_bindLine","_initPosition","refreshElementPosition","getPrevLayout","_b","contentX_1","_c","top_1","bottom","right","_refreshContentWithLayout","canIEnter","add","doorClosed","outerWidth","elements","start","end","offsetX","_initHeight","context","_initLayout","_getPrevLine","_getOffsetY","_refreshWidthHeight","_closeLine","_refreshXAlign","prevLine","prevLayout","bindElement","addElement","flexBox","pre","exactValue","flexTotal","_super","closeLine","calcFlex","getPreLine","_refreshElementPosition","initLayout","getOffsetY","_calcFlex","_this","containerWidth","initHeight","init","onElementAdd","isVisible","getLayer","getRenderer","renderer","paint","lastPaintTime","__proto__","create","lines","measureText","_calcLine","_getFont","textWidth","parentContentWidth","lineIndex","lineText","lastLayout","maxLine","substring","_drawBackground","_drawText","_drawBox","createTextElement","getCtx","getCanvas","createViewElement","deepTraversal","nodes","unshift","shift","wideTraversal","getBorderRadius","createCanvasRenderer","threshold","timer","imageBus","isAnimate","lastFrameComplete","throttle","setTimeout","_restore","save","restore","_path","beginPath","closePath","_helpParentRestoreCtx","shadowBlur","borderStyle","w","h","strokeStyle","lineJoin","setLineDash","stroke","lineWidth","topBorder","moveTo","rightBorder","bottomBorder","leftBorder","backgroundColor","shadowColor","opacity","shadowOffsetX","shadowOffsetY","globalAlpha","fillStyle","fill","_clip","_parseBackground","fillRect","isDebug","strokeRect","borderBase","clip","gradient","createLinearGradient","addColorStop","textIndent","textDecoration","font","textBaseline","_x","_y","this_1","fillText","offset","decorationType_1","decorationY","_layout","fontHeight","lineTo","_drawImage","_image","mode","attrs","_imageInfo","sx","sy","swidth","sheight","dx","dy","dwidth","dheight","imageW","imageH","drawImage","_drawScroll","translate","currentScrollX","currentScrollY","_animate","now","Date","window","requestAnimationFrame","debug","afterPaint","arc","angle","actualBoundingBoxAscent","getImageInstance","src","url","instance","image","createImage","warn","onload","Promise","resolve","reject","downloadFile","success","getImageInfo","tempFilePath","res1","target","fail","then","catch","Image","crossOrigin","e","info","onerror","clearRect","_continue","_next","_callContinue","_callNext","stack","pop","walk","renderNode","callContinue","callNext","draw","renderFPS","readyToRender","animate","requestRepaint","canvas","stopAnimate","onEffectFinished","list","keys","all","XCanvas","createNodeOps","createElement","insert","anchor","tag","createText","createComment","setText","setElementText","parentNode","nextSibling","createRenderer","hostInsert","hostRemove","hostPatchProp","patchProp","hostCreateElement","hostCreateText","hostSetText","hostSetElementText","hostNextSibling","patch","n1","n2","parentComponent","isSameVNodeType","getNextHostNode","unmount","processText","processElement","mountElement","patchElement","mountChildren","oldProps","newProps","patchChildren","patchProps","c1","c2","patchUnkeyedChildren","oldLength","newLength","commonLength","Math","min","nextChild","unmountChildren","doRemove","optimized","_vnode","cb","splice","flushPreFlushCbs","createApp","propsOrChildren","createLayer","p2cList","c2pList","nodeList","_initRender","startTime","_initC2PList","_initP2CList","_flow","lifecycle","_repaint","_initPaintList","_reflowElement","elm","onElementChange","_callBeforePaint","beforePaint","update","onElementRemove","getElementBy","name","arg","createCanvasElement","createRootCanvasElement"],"mappings":"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","x_google_ignoreList":[7]}